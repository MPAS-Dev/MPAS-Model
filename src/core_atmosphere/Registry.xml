<?xml version="1.0"?>
<registry model="mpas" core="atmosphere" core_abbrev="atm" version="7.0">

<!-- **************************************************************************************** -->
<!-- ************************************** Dimensions ************************************** -->
<!-- **************************************************************************************** -->

        <dims>
                <dim name="nCells"
                     description="The number of Voronoi cells in the primal mesh"/>
                <dim name="nEdges"
                     description="The number of cell faces (edges) in the primal and dual meshes"/>
                <dim name="maxEdges"
                     description="The largest number of neighbors that a primal mesh cell may have"/>
                <dim name="maxEdges2"
                     description="Twice the value of maxEdges"/>
                <dim name="nVertices"
                     description="The number of Delaunay triangles in the dual mesh, equivalent to the number of cell corners in the primal mesh"/>
                <dim name="TWO"                definition="2"
                     description="A constant value of 2"/>
                <dim name="THREE"              definition="3"
                     description="A constant value of 3"/>
                <dim name="vertexDegree"
                     description="The number of edges or cells that meet at vertices"/>
                <dim name="FIFTEEN"            definition="15"
                     description="A constant value of 15"/>
                <dim name="TWENTYONE"          definition="21"
                     description="A constant value of 21"/>
                <dim name="R3"                 definition="3"
                     description="The dimensionality of vectors in $\Re^3$"/>
                <dim name="nVertLevels"
                     description="The number of atmospheric layers"/>
                <dim name="nVertLevelsP1"      definition="nVertLevels+1"
                     description="The number of atmospheric levels, always one more than the number of layers"/>
                <dim name="nMonths"            definition="namelist:months"
                     description="The number of months in a year"/>
                <dim name="nSoilLevels"        definition="namelist:num_soil_layers"
                     description="The number of soil layers used by the land-surface scheme"/>
                <dim name="nLags"              definition="namelist:input_soil_temperature_lag"
                     description="The number of days affecting the deep soil temperature"/>
                <dim name="nOznLevels"         definition="namelist:noznlev"
                     description="The number of prescribed pressure levels for input climatological ozone volume mixing ratios"/>
                <dim name="nAerLevels"         definition="namelist:naerlev"
                     description="number of prescribed pressure levels for input climatological aerosol mixing ratio"/>
                <dim name="cam_dim1"           definition="namelist:camdim1"
                     description="dimension of CAM radiation absorption save array"/>
                <dim name="nVertLevelsP2"      definition="nVertLevels+2"
                     description="Two more than the number of atmospheric layers"/>
        </dims>


<!-- **************************************************************************************** -->
<!-- ************************************** Namelists *************************************** -->
<!-- **************************************************************************************** -->

        <nml_record name="nhyd_model" in_defaults="true">
                <nml_option name="config_time_integration" type="character" default_value="SRK3" in_defaults="false"
                     units="-"
                     description="Time integration scheme"
                     possible_values="`SRK3'"/>

                <nml_option name="config_time_integration_order" type="integer" default_value="2"
                     units="-"
                     description="Order for RK time integration"
                     possible_values="2 or 3"/>

                <nml_option name="config_dt" type="real" default_value="720.0"
                     units="s"
                     description="Model time step, seconds"
                     possible_values="Positive real values"/>

                <nml_option name="config_calendar_type" type="character" default_value="gregorian" in_defaults="false"
                     units="-"
                     description="Simulation calendar type"
                     possible_values="`gregorian',`gregorian_noleap'"/>

                <nml_option name="config_start_time" type="character" default_value="2010-10-23_00:00:00"
                     units="-"
                     description="Starting time for model simulation"
                     possible_values="`YYYY-MM-DD_hh:mm:ss'"/>

                <nml_option name="config_stop_time" type="character" default_value="none" in_defaults="false"
                     units="-"
                     description="Stopping time for model simulation"
                     possible_values="`YYYY-MM-DD_hh:mm:ss'"/>

                <nml_option name="config_run_duration" type="character" default_value="5_00:00:00"
                     units="-"
                     description="Length of model simulation"
                     possible_values="[DDD_]hh:mm:ss"/>

                <nml_option name="config_split_dynamics_transport" type="logical" default_value="true"
                     units="-"
                     description="Whether to super-cycle scalar transport"
                     possible_values="Logical values"/>

                <nml_option name="config_number_of_sub_steps" type="integer" default_value="2"
                     units="-"
                     description="Number of acoustic steps per full RK step"
                     possible_values="Positive, even integer values, typically 2 or 6 depending on transport splitting"/>

                <nml_option name="config_dynamics_split_steps" type="integer" default_value="3"
                     units="-"
                     description="When config_split_dynamics_transport = T, the number of RK steps per transport step"
                     possible_values="Positive integer values"/>

                <nml_option name="config_h_mom_eddy_visc2" type="real" default_value="0.0"
                     units="m^2 s^{-1}"
                     description="$\nabla^2$ eddy viscosity for horizontal diffusion of momentum"
                     possible_values="Positive real values"/>

                <nml_option name="config_h_mom_eddy_visc4" type="real" default_value="0.0"
                     units="m^4 s^{-1}"
                     description="$\nabla^4$ eddy hyper-viscosity for horizontal diffusion of momentum"
                     possible_values="Positive real values"/>

                <nml_option name="config_v_mom_eddy_visc2" type="real" default_value="0.0"
                     units="m^2 s^{-1}"
                     description="$\nabla^2$ eddy viscosity for vertical diffusion of momentum"
                     possible_values="Positive real values"/>

                <nml_option name="config_h_theta_eddy_visc2" type="real" default_value="0.0"
                     units="m^2 s^{-1}"
                     description="$\nabla^2$ eddy viscosity for horizontal diffusion of theta"
                     possible_values="Positive real values"/>

                <nml_option name="config_h_theta_eddy_visc4" type="real" default_value="0.0"
                     units="m^4 s^{-1}"
                     description="$\nabla^4$ eddy hyper-viscosity for horizontal diffusion of theta"
                     possible_values="Positive real values"/>

                <nml_option name="config_v_theta_eddy_visc2" type="real" default_value="0.0"
                     units="m^2 s^{-1}"
                     description="$\nabla^2$ eddy viscosity for vertical diffusion of theta"
                     possible_values="Positive real values"/>

                <nml_option name="config_horiz_mixing" type="character" default_value="2d_smagorinsky"
                     units="-"
                     description="Formulation of horizontal mixing"
                     possible_values="`2d_fixed' or `2d_smagorinsky'"/>

                <nml_option name="config_len_disp" type="real" default_value="120000.0"
                     units="m"
                     description="Horizontal length scale, used by the Smagorinsky formulation of horizontal diffusion and by 3-d divergence damping"
                     possible_values="Positive real values"/>

                <nml_option name="config_visc4_2dsmag" type="real" default_value="0.05"
                     units="-"
                     description="Scaling coefficient of $\delta x^3$ to obtain $\nabla^4$ diffusion coefficient"
                     possible_values="Non-negative real values"/>

                <nml_option name="config_del4u_div_factor" type="real" default_value="10.0" in_defaults="false"
                     units="-"
                     description="Scaling factor for the divergent component of $\nabla^4 u$ calculation"
                     possible_values="Positive real values"/>

                <nml_option name="config_w_adv_order" type="integer" default_value="3"
                     units="-"
                     description="Horizontal advection order for w"
                     possible_values="2, 3, or 4"/>

                <nml_option name="config_theta_adv_order" type="integer" default_value="3"
                     units="-"
                     description="Horizontal advection order for theta"
                     possible_values="2, 3, or 4"/>

                <nml_option name="config_scalar_adv_order" type="integer" default_value="3"
                     units="-"
                     description="Horizontal advection order for scalars"
                     possible_values="2, 3, or 4"/>

                <nml_option name="config_u_vadv_order" type="integer" default_value="3"
                     units="-"
                     description="Vertical advection order for normal velocities (u)"
                     possible_values="2, 3, or 4"/>

                <nml_option name="config_w_vadv_order" type="integer" default_value="3"
                     units="-"
                     description="Vertical advection order for w"
                     possible_values="2, 3, or 4"/>

                <nml_option name="config_theta_vadv_order" type="integer" default_value="3"
                     units="-"
                     description="Vertical advection order for theta"
                     possible_values="2, 3, or 4"/>

                <nml_option name="config_scalar_vadv_order" type="integer" default_value="3"
                     units="-"
                     description="Vertical advection order for scalars"
                     possible_values="2, 3, or 4"/>

                <nml_option name="config_scalar_advection" type="logical" default_value="true"
                     units="-"
                     description="Whether to advect scalar fields"
                     possible_values=".true. or .false."/>

                <nml_option name="config_positive_definite" type="logical" default_value="false"
                     units="-"
                     description="Whether to enable positive-definite advection of scalars"
                     possible_values=".true. or .false."/>

                <nml_option name="config_monotonic" type="logical" default_value="true"
                     units="-"
                     description="Whether to enable monotonic limiter in scalar advection"
                     possible_values=".true. or .false."/>

                <nml_option name="config_coef_3rd_order" type="real" default_value="0.25"
                     units="-"
                     description="Upwinding coefficient in the 3rd order advection scheme"
                     possible_values="0 $\leq$ config_coef_3rd_order $\leq$ 1"/>

                <nml_option name="config_smagorinsky_coef" type="real" default_value="0.125" in_defaults="false"
                     units="-"
                     description="Dimensionless empirical parameter relating the strain tensor to the eddy viscosity in the Smagorinsky turbulence model"
                     possible_values="Real values typically in the range 0.1 to 0.4"/>

                <nml_option name="config_mix_full" type="logical" default_value="true" in_defaults="false"
                     units="-"
                     description="Mix full $\theta$ and $u$ fields, or mix perturbation from intitial state"
                     possible_values=".true. or .false."/>

                <nml_option name="config_epssm" type="real" default_value="0.1"
                     units="-"
                     description="Off-centering parameter for the vertically implicit acoustic integration"
                     possible_values="Positive real values"/>

                <nml_option name="config_smdiv" type="real" default_value="0.1"
                     units="-"
                     description="3-d divergence damping coefficient"
                     possible_values="Positive real values"/>

                <nml_option name="config_apvm_upwinding" type="real" default_value="0.5" in_defaults="false"
                     units="-"
                     description="Amount of upwinding in APVM"
                     possible_values="0 $\leq$ config_apvm_upwinding $\leq$ 1"/>

                <nml_option name="config_h_ScaleWithMesh" type="logical" default_value="true" in_defaults="false"
                     units="-"
                     description="Scale eddy viscosities with mesh-density function for horizontal diffusion"
                     possible_values=".true. or .false."/>

                <nml_option name="config_num_halos" type="integer" default_value="2" in_defaults="false"
                     units="-"
                     description="Number of halo layers for fields"
                     possible_values="Integer values, typically 2 or 3; DO NOT CHANGE"/>
        </nml_record>

        <nml_record name="damping" in_defaults="true">
                <nml_option name="config_zd" type="real" default_value="22000.0"
                     units="m"
                     description="Height MSL to begin w-damping profile"
                     possible_values="Positive real values"/>

                <nml_option name="config_xnutr" type="real" default_value="0.2"
                     units="-"
                     description="Maximum w-damping coefficient at model top"
                     possible_values="0 $\leq$ config_xnutr $\leq$ 1"/>

                <nml_option name="config_mpas_cam_coef" type="real" default_value="0.0" in_defaults="false"
                     units="-"
                     description="Coefficient for scaling the 2nd-order horizontal mixing in the mpas_cam absorbing layer"
                     possible_values="0 $\leq$ config_mpas_cam_coef $\leq$ 1, standard value is 0.2"/>

                <nml_option name="config_rayleigh_damp_u" type="logical" default_value="false" in_defaults="false"
                     units="-"
                     description="Whether to apply Rayleigh damping on horizontal velocity in the top-most model levels. The number of levels is specified by the config_number_rayleigh_damp_u_levels option, and the damping timescale is specified by the config_rayleigh_damp_u_timescale_days option."
                     possible_values=".true. or .false."/>

                <nml_option name="config_rayleigh_damp_u_timescale_days" type="real" default_value="5.0" in_defaults="false"
                     units="days"
                     description="Timescale, in days (86400 s), for the Rayleigh damping on horizontal velocity in the top-most model levels."
                     possible_values="Positive real values"/>

                <nml_option name="config_number_rayleigh_damp_u_levels" type="integer" default_value="6" in_defaults="false"
                     units="-"
                     description="Number layers in which to apply Rayleigh damping on horizontal velocity at top of model; damping linearly ramps to zero by layer number from the top"
                     possible_values="Positive integer values"/>
        </nml_record>

        <nml_record name="limited_area" in_defaults="true">
                <nml_option name="config_apply_lbcs" type="logical" default_value="false"
                     units="-"
                     description="Whether to apply lateral boundary conditions"
                     possible_values="true or false; this option must be set to true for limited-area simulations and false for global simulations"/>
	</nml_record>

        <nml_record name="io" in_defaults="true">
                <nml_option name="config_restart_timestamp_name" type="character" default_value="restart_timestamp" in_defaults="false"
                     units="-"
                     description="Filename used to store most recent restart time stamp"
                     possible_values="Any valid filename"/>

                <nml_option name="config_pio_num_iotasks" type="integer" default_value="0"
                     units="-"
                     description="Number of tasks to perform file I/O"
                     possible_values="Integer valued, 0 $\leq$ config_pio_num_iotasks $\leq$ \# MPI tasks, 0 indicates all tasks perform I/O"/>

                <nml_option name="config_pio_stride" type="integer" default_value="1"
                     units="-"
                     description="Stride between file I/O tasks"
                     possible_values="Integer valued, $\leq$ (\# MPI tasks) / config_pio_num_iotasks"/>
        </nml_record>

        <nml_record name="decomposition" in_defaults="true">
                <nml_option name="config_block_decomp_file_prefix" type="character" default_value="x1.40962.graph.info.part."
                     units="-"
                     description="Prefix of graph decomposition file, to be suffixed with the MPI task count"
                     possible_values="Any valid filename"/>

                <nml_option name="config_number_of_blocks" type="integer" default_value="0" in_defaults="false"
                     units="-"
                     description="Number of blocks to assign to each MPI task"
                     possible_values="Positive integer values"/>

                <nml_option name="config_explicit_proc_decomp" type="logical" default_value="false" in_defaults="false"
                     units="-"
                     description="Whether to use an explicit mapping of blocks to MPI tasks"
                     possible_values=".true. or .false."/>

                <nml_option name="config_proc_decomp_file_prefix" type="character" default_value="graph.info.part." in_defaults="false"
                     units="-"
                     description="Prefix of block mapping file"
                     possible_values="Any valid filename"/>
        </nml_record>

        <nml_record name="restart" in_defaults="true">
                <nml_option name="config_do_restart" type="logical" default_value="false"
                     units="-"
                     description="Whether this run of the model is to restart from a previous restart file or not"
                     possible_values=".true. or .false."/>

                <nml_option name="config_do_DAcycling" type="logical" default_value="false" in_defaults="false"
                     units="-"
                     description="Whether to re-compute coupled fields $\theta_m$, $\tilde{\rho}$, $\rho u$, etc. from uncoupled fields when restarting the model; used for cycling DA experiments that analyze uncoupled fields in restart files"
                     possible_values=".true. or .false."/>
        </nml_record>

        <nml_record name="printout" in_defaults="true">
                <nml_option name="config_print_global_minmax_vel" type="logical" default_value="true"
                     units="-"
                     description="Whether to print the global min/max of horizontal normal velocity and vertical velocity each timestep"
                     possible_values=".true. or .false."/>

                <nml_option name="config_print_detailed_minmax_vel" type="logical" default_value="false"
                     units="-"
                     description="Whether to print the global min/max of horizontal normal velocity and vertical velocity each timestep, along with the location in the domain where those extrema occurred"
                     possible_values=".true. or .false."/>

                <nml_option name="config_print_global_minmax_sca" type="logical" default_value="false" in_defaults="false"
                     units="-"
                     description="Whether to print the global min/max of scalar fields each timestep"
                     possible_values=".true. or .false."/>
        </nml_record>

        <nml_record name="IAU" in_defaults="true">
                <nml_option name="config_IAU_option" type="character" default_value="off"
                     units="-"
                     description="Incremental Analysis Update scheme"
                     possible_values="`off' or `on'; `off' turns off IAU, `on' uses equal weighting of increments across the IAU window"/>
                <nml_option name="config_IAU_window_length_s" type="real" default_value="21600."
                     units="s"
                     description="Length of window over which analysis increments are applied"
                     possible_values="Non-negative real values"/>
	</nml_record>

        <nml_record name="assimilation" in_defaults="false">
                <nml_option name="config_jedi_da" type="logical" default_value="false"
                     units="-"
                     description="Whether this run is within the JEDI data assimilation framework; used to add temperature and specific humidity as diagnostics"
                     possible_values=".true. or .false."/>
        </nml_record>

<!-- **************************************************************************************** -->
<!-- **************************************  Packages  ************************************** -->
<!-- **************************************************************************************** -->

        <packages>
                <package name="mp_kessler_in" description="parameterization of kessler microphysics."/>
                <package name="mp_thompson_in" description="parameterization of Thompson cloud microphysics."/>
                <package name="mp_wsm6_in" description="parameterization of WSM6 cloud microphysics."/>
                <package name="cu_grell_freitas_in" description="parameterization of Grell-Freitas convection."/>
                <package name="cu_kain_fritsch_in" description="parameterization of Kain-Fritsch convection."/>
                <package name="cu_tiedtke_in" description="parameterization of Tiedtke convection."/>
                <package name="bl_ysu_in" description="parameterization of YSU Planetary Boundary Layer."/>
                <package name="bl_mynn_in" description="parameterization of MYNN Planetary Boundary Layer."/>

                <package name="iau" description="Incremental Analysis Update"/>
                <package name="limited_area" description="Limited-area simulations, which have lateral boundaries"/>
                <package name="jedi_da" description="Data Assimilation in JEDI framework"/>
        </packages>


<!-- **************************************************************************************** -->
<!-- *************************************** Streams **************************************** -->
<!-- **************************************************************************************** -->

	<streams>
		<stream name="input" 
                        type="input" 
                        filename_template="x1.40962.init.nc" 
                        input_interval="initial_only"
                        immutable="true">

			<var name="latCell"/>
			<var name="lonCell"/>
			<var name="xCell"/>
			<var name="yCell"/>
			<var name="zCell"/>
			<var name="indexToCellID"/>
			<var name="latEdge"/>
			<var name="lonEdge"/>
			<var name="xEdge"/>
			<var name="yEdge"/>
			<var name="zEdge"/>
			<var name="indexToEdgeID"/>
			<var name="latVertex"/>
			<var name="lonVertex"/>
			<var name="xVertex"/>
			<var name="yVertex"/>
			<var name="zVertex"/>
			<var name="indexToVertexID"/>
			<var name="cellsOnEdge"/>
			<var name="nEdgesOnCell"/>
			<var name="nEdgesOnEdge"/>
			<var name="edgesOnCell"/>
			<var name="edgesOnEdge"/>
			<var name="weightsOnEdge"/>
			<var name="dvEdge"/>
			<var name="dcEdge"/>
			<var name="angleEdge"/>
			<var name="areaCell"/>
			<var name="areaTriangle"/>
			<var name="edgeNormalVectors"/>
			<var name="localVerticalUnitVectors"/>
			<var name="cellTangentPlane"/>
			<var name="cellsOnCell"/>
			<var name="verticesOnCell"/>
			<var name="verticesOnEdge"/>
			<var name="edgesOnVertex"/>
			<var name="cellsOnVertex"/>
			<var name="kiteAreasOnVertex"/>
			<var name="fEdge"/>
			<var name="fVertex"/>
			<var name="meshDensity"/>
			<var name="bdyMaskCell"/>
			<var name="bdyMaskEdge"/>
			<var name="bdyMaskVertex"/>
			<var name="cf1"/>
			<var name="cf2"/>
			<var name="cf3"/>
			<var name="zgrid"/>
			<var name="rdzw"/>
			<var name="dzu"/>
			<var name="rdzu"/>
			<var name="fzm"/>
			<var name="fzp"/>
			<var name="zxu"/>
			<var name="zz"/>
			<var name="zb"/>
			<var name="zb3"/>
			<var name="dss"/>
			<var name="u_init"/>
			<var name="v_init"/>
			<var name="t_init"/>
			<var name="qv_init"/>
			<var name="deriv_two"/>
			<var name="defc_a"/>
			<var name="defc_b"/>
			<var name="coeffs_reconstruct"/>
			<var_array name="scalars"/>
			<var name="initial_time"/>
			<var name="xtime"/>
			<var name="u"/>
			<var name="w"/>
			<var name="rho"/>
			<var name="theta"/>
			<var name="relhum"/>
			<var name="rho_base"/>
			<var name="theta_base"/>
			<var name="surface_pressure"/>
			<var name="isltyp"/>
			<var name="ivgtyp"/>
			<var name="mminlu"/>
			<var name="isice_lu"/>
			<var name="iswater_lu"/>
			<var name="landmask"/>
			<var name="shdmin"/>
			<var name="shdmax"/>
			<var name="snoalb"/>
			<var name="albedo12m"/>
			<var name="greenfrac"/>
			<var name="sfc_albbck"/>
			<var name="skintemp"/>
			<var name="snow"/>
			<var name="snowc"/>
			<var name="snowh"/>
			<var name="sst"/>
			<var name="tmn"/>
			<var name="vegfra"/>
			<var name="seaice"/>
			<var name="xice"/>
			<var name="xland"/>
			<var name="u10"/>
			<var name="v10"/>
			<var name="q2"/>
			<var name="t2m"/>
			<var name="precipw"/>
			<var name="dzs"/>
			<var name="sh2o"/>
			<var name="smois"/>
			<var name="tslb"/>
			<var name="var2d"/>
			<var name="con"/>
			<var name="oa1"/>
			<var name="oa2"/>
			<var name="oa3"/>
			<var name="oa4"/>
			<var name="ol1"/>
			<var name="ol2"/>
			<var name="ol3"/>
			<var name="ol4"/>
			<var name="h_oml_initial"/>
		</stream>

		<stream name="restart" 
                        type="input;output" 
                        filename_template="restart.$Y-$M-$D_$h.$m.$s.nc" 
                        input_interval="initial_only" 
                        output_interval="1_00:00:00" 
                        immutable="true">

			<var name="latCell"/>
			<var name="lonCell"/>
			<var name="xCell"/>
			<var name="yCell"/>
			<var name="zCell"/>
			<var name="indexToCellID"/>
			<var name="latEdge"/>
			<var name="lonEdge"/>
			<var name="xEdge"/>
			<var name="yEdge"/>
			<var name="zEdge"/>
			<var name="indexToEdgeID"/>
			<var name="latVertex"/>
			<var name="lonVertex"/>
			<var name="xVertex"/>
			<var name="yVertex"/>
			<var name="zVertex"/>
			<var name="indexToVertexID"/>
			<var name="cellsOnEdge"/>
			<var name="nEdgesOnCell"/>
			<var name="nEdgesOnEdge"/>
			<var name="edgesOnCell"/>
			<var name="edgesOnEdge"/>
			<var name="weightsOnEdge"/>
			<var name="dvEdge"/>
			<var name="dcEdge"/>
			<var name="angleEdge"/>
			<var name="areaCell"/>
			<var name="areaTriangle"/>
			<var name="edgeNormalVectors"/>
			<var name="localVerticalUnitVectors"/>
			<var name="cellTangentPlane"/>
			<var name="cellsOnCell"/>
			<var name="verticesOnCell"/>
			<var name="verticesOnEdge"/>
			<var name="edgesOnVertex"/>
			<var name="cellsOnVertex"/>
			<var name="kiteAreasOnVertex"/>
			<var name="fEdge"/>
			<var name="fVertex"/>
			<var name="meshDensity"/>
			<var name="meshScalingDel2"/>
			<var name="meshScalingDel4"/>
			<var name="meshScalingRegionalCell"/>
			<var name="meshScalingRegionalEdge"/>
			<var name="bdyMaskCell"/>
			<var name="bdyMaskEdge"/>
			<var name="bdyMaskVertex"/>
			<var name="cf1"/>
			<var name="cf2"/>
			<var name="cf3"/>
			<var name="zgrid"/>
			<var name="rdzw"/>
			<var name="dzu"/>
			<var name="rdzu"/>
			<var name="fzm"/>
			<var name="fzp"/>
			<var name="zxu"/>
			<var name="zz"/>
			<var name="zb"/>
			<var name="zb3"/>
			<var name="dss"/>
			<var name="u_init"/>
			<var name="v_init"/>
			<var name="t_init"/>
			<var name="qv_init"/>
			<var name="deriv_two"/>
			<var name="defc_a"/>
			<var name="defc_b"/>
			<var name="coeffs_reconstruct"/>
			<var name="east"/>
			<var name="north"/>
			<var_array name="scalars"/>
			<var name="rainprod" packages="mp_thompson_in"/>
			<var name="evapprod" packages="mp_thompson_in"/>
			<var name="re_cloud" packages="mp_thompson_in;mp_wsm6_in"/>
			<var name="re_ice" packages="mp_thompson_in;mp_wsm6_in"/>
			<var name="re_snow" packages="mp_thompson_in;mp_wsm6_in"/>
			<var name="nt_c" packages="mp_thompson_in"/>
			<var name="mu_c" packages="mp_thompson_in"/>
			<var name="initial_time"/>
			<var name="xtime"/>
			<var name="u"/>
			<var name="w"/>
			<var name="rho_zz"/>
			<var name="theta_m"/>
			<var name="pressure_p"/>
			<var name="rho"/>
			<var name="theta"/>
			<var name="relhum"/>
			<var name="uReconstructZonal"/>
			<var name="uReconstructMeridional"/>
			<var name="circulation"/>
			<var name="exner"/>
			<var name="exner_base"/>
			<var name="rtheta_base"/>
			<var name="pressure_base"/>
			<var name="rho_base"/>
			<var name="theta_base"/>
			<var name="ru"/>
			<var name="ru_p"/>
			<var name="rw"/>
			<var name="rw_p"/>
			<var name="rtheta_p"/>
			<var name="rho_p"/>
			<var name="surface_pressure"/>
                        <var name="tend_sfc_pressure"/>
			<var name="rt_diabatic_tend"/>
			<var name="nsteps_accum"/>
			<var name="ndays_accum"/>
			<var name="tlag"/>
			<var name="tday_accum"/>
			<var name="tyear_mean"/>
			<var name="tyear_accum"/>
			<var name="refl10cm_max"/>
			<var name="i_rainnc"/>
			<var name="rainncv"/>
			<var name="rainnc"/>
			<var name="snownc"/>
			<var name="graupelnc"/>
			<var name="sr"/>
			<var name="i_rainc"/>
			<var name="cuprec"/>
			<var name="rainc"/>
			<var name="raincv"/>
			<var name="nca"/>
			<var name="cubot"/>
			<var name="cutop"/>
			<var name="w0avg"/>
                        <var name="qcg"/>
                        <var name="sh3d"/>
                        <var name="qke"/>
                        <var name="qke_adv"/>
                        <var name="cov"/>
                        <var name="qsq"/>
                        <var name="tsq"/>
                        <var name="tke_pbl"/>
                        <var name="wstar"/>
                        <var name="delta"/>
                        <var name="el_pbl"/>
                        <var name="ch"/>
			<var name="kpbl"/>
			<var name="hpbl"/>
			<var name="hfx"/>
			<var name="mavail"/>
			<var name="mol"/>
			<var name="qfx"/>
			<var name="qsfc"/>
			<var name="ust"/>
			<var name="ustm"/>
			<var name="zol"/>
			<var name="znt"/>
			<var name="br"/>
			<var name="cd"/>
			<var name="cda"/>
			<var name="chs"/>
			<var name="chs2"/>
			<var name="cqs2"/>
			<var name="ck"/>
			<var name="cka"/>
			<var name="cpm"/>
			<var name="flhc"/>
			<var name="flqc"/>
			<var name="gz1oz0"/>
			<var name="lh"/>
			<var name="psim"/>
			<var name="psih"/>
			<var name="qgh"/>
			<var name="regime"/>
			<var name="rmol"/>
			<var name="wspd"/>
			<var name="fh"/>
			<var name="fm"/>
			<var name="u10"/>
			<var name="v10"/>
			<var name="q2"/>
			<var name="t2m"/>
			<var name="th2m"/>
			<var name="dusfcg"/>
			<var name="dvsfcg"/>
			<var name="dtaux3d"/>
			<var name="dtauy3d"/>
			<var name="rubldiff"/>
			<var name="rvbldiff"/>
			<var name="i_acswdnb"/>
			<var name="i_acswdnbc"/>
			<var name="i_acswdnt"/>
			<var name="i_acswdntc"/>
			<var name="i_acswupb"/>
			<var name="i_acswupbc"/>
			<var name="i_acswupt"/>
			<var name="i_acswuptc"/>
			<var name="acswdnb"/>
			<var name="acswdnbc"/>
			<var name="acswdnt"/>
			<var name="acswdntc"/>
			<var name="acswupb"/>
			<var name="acswupbc"/>
			<var name="acswupt"/>
			<var name="acswuptc"/>
			<var name="gsw"/>
			<var name="i_aclwdnb"/>
			<var name="i_aclwdnbc"/>
			<var name="i_aclwdnt"/>
			<var name="i_aclwdntc"/>
			<var name="i_aclwupb"/>
			<var name="i_aclwupbc"/>
			<var name="i_aclwupt"/>
			<var name="i_aclwuptc"/>
			<var name="aclwdnb"/>
			<var name="aclwdnbc"/>
			<var name="aclwdnt"/>
			<var name="aclwdntc"/>
			<var name="aclwupb"/>
			<var name="aclwupbc"/>
			<var name="aclwupt"/>
			<var name="aclwuptc"/>
			<var name="glw"/>
			<var name="o3clim"/>
			<var name="o3vmr"/>
			<var name="acsnom"/>
			<var name="acsnow"/>
			<var name="canwat"/>
			<var name="chklowq"/>
			<var name="grdflx"/>
			<var name="lai"/>
			<var name="noahres"/>
			<var name="potevp"/>
			<var name="sfc_albedo"/>
			<var name="sfc_albedo_seaice"/>
			<var name="sfc_emiss"/>
			<var name="sfc_emibck"/>
			<var name="sfcrunoff"/>
			<var name="smstav"/>
			<var name="smstot"/>
			<var name="snopcx"/>
			<var name="snotime"/>
			<var name="sstsk"/>
			<var name="sstsk_dtc"/>
			<var name="sstsk_dtw"/>
			<var name="thc"/>
			<var name="udrunoff"/>
			<var name="xicem"/>
			<var name="z0"/>
			<var name="zs"/>
			<var name="k22_shallow"/>
			<var name="kbcon_shallow"/>
			<var name="ktop_shallow"/>
			<var name="ktop_deep"/>
			<var name="xmb_total"/>
			<var name="xmb_shallow"/>
			<var name="qc_cu"/>
			<var name="qi_cu"/>
			<var name="rthcuten"/>
			<var name="rqvcuten"/>
			<var name="rqccuten"/>
			<var name="rqicuten"/>
			<var name="rqrcuten"/>
			<var name="rqscuten"/>
			<var name="rqvdynten"/>
			<var name="rthdynten"/>
			<var name="rucuten"/>
			<var name="rvcuten"/>
			<var name="rublten"/>
			<var name="rvblten"/>
			<var name="rthblten"/>
			<var name="rqvblten"/>
			<var name="rqcblten"/>
			<var name="rqiblten"/>
			<var name="rniblten"/>
			<var name="rthratensw"/>
			<var name="rthratenlw"/>
			<var name="pin"/>
			<var name="ozmixm"/>
			<var name="isltyp"/>
			<var name="ivgtyp"/>
			<var name="mminlu"/>
			<var name="isice_lu"/>
			<var name="iswater_lu"/>
			<var name="landmask"/>
			<var name="shdmin"/>
			<var name="shdmax"/>
			<var name="snoalb"/>
			<var name="albedo12m"/>
			<var name="greenfrac"/>
			<var name="sfc_albbck"/>
			<var name="skintemp"/>
			<var name="snow"/>
			<var name="snowc"/>
			<var name="snowh"/>
			<var name="sst"/>
			<var name="tmn"/>
			<var name="vegfra"/>
			<var name="seaice"/>
			<var name="xice"/>
			<var name="xland"/>
			<var name="dzs"/>
			<var name="smcrel"/>
			<var name="sh2o"/>
			<var name="smois"/>
			<var name="tslb"/>
			<var name="var2d"/>
			<var name="con"/>
			<var name="oa1"/>
			<var name="oa2"/>
			<var name="oa3"/>
			<var name="oa4"/>
			<var name="ol1"/>
			<var name="ol2"/>
			<var name="ol3"/>
			<var name="ol4"/>
			<var name="t_oml"/>
			<var name="t_oml_initial"/>
			<var name="t_oml_200m_initial"/>
			<var name="h_oml"/>
			<var name="h_oml_initial"/>
			<var name="hu_oml"/>
			<var name="hv_oml"/>
		</stream>

		<stream name="output" 
                        type="output" 
                        filename_template="history.$Y-$M-$D_$h.$m.$s.nc" 
                        output_interval="6:00:00"
                        runtime_format="separate_file">

			<var name="latCell"/>
			<var name="lonCell"/>
			<var name="xCell"/>
			<var name="yCell"/>
			<var name="zCell"/>
			<var name="indexToCellID"/>
			<var name="latEdge"/>
			<var name="lonEdge"/>
			<var name="xEdge"/>
			<var name="yEdge"/>
			<var name="zEdge"/>
			<var name="indexToEdgeID"/>
			<var name="latVertex"/>
			<var name="lonVertex"/>
			<var name="xVertex"/>
			<var name="yVertex"/>
			<var name="zVertex"/>
			<var name="indexToVertexID"/>
			<var name="cellsOnEdge"/>
			<var name="nEdgesOnCell"/>
			<var name="nEdgesOnEdge"/>
			<var name="edgesOnCell"/>
			<var name="edgesOnEdge"/>
			<var name="weightsOnEdge"/>
			<var name="dvEdge"/>
			<var name="dcEdge"/>
			<var name="angleEdge"/>
			<var name="areaCell"/>
			<var name="areaTriangle"/>
			<var name="cellsOnCell"/>
			<var name="verticesOnCell"/>
			<var name="verticesOnEdge"/>
			<var name="edgesOnVertex"/>
			<var name="cellsOnVertex"/>
			<var name="kiteAreasOnVertex"/>
			<var name="meshDensity"/>
			<var name="zgrid"/>
			<var name="fzm"/>
			<var name="fzp"/>
			<var name="zz"/>
			<var name="initial_time"/>
			<var name="xtime"/>
			<var name="u"/>
			<var name="w"/>
			<var name="pressure"/>
			<var name="surface_pressure"/>
			<var name="rho"/>
			<var name="theta"/>
			<var_array name="scalars"/>
			<var name="relhum"/>
			<var name="divergence"/>
			<var name="vorticity"/>
			<var name="ke"/>
			<var name="uReconstructZonal"/>
			<var name="uReconstructMeridional"/>

                        <!-- Begin Ertel PV diagnostics defined in diagnostics/Registry_pv.xml -->
			<var name="ertel_pv"/>
			<var name="u_pv"/>
			<var name="v_pv"/>
			<var name="theta_pv"/>
			<var name="vort_pv"/>
			<var name="depv_dt_lw"/>
			<var name="depv_dt_sw"/>
			<var name="depv_dt_bl"/>
			<var name="depv_dt_cu"/>
			<var name="depv_dt_mix"/>
			<var name="dtheta_dt_mp"/>
			<var name="depv_dt_mp"/>
			<var name="depv_dt_diab"/>
			<var name="depv_dt_fric"/>
			<var name="depv_dt_diab_pv"/>
			<var name="depv_dt_fric_pv"/>
			<var name="iLev_DT"/>
                        <!-- End Ertel PV diagnostics defined in diagnostics/Registry_pv.xml -->

			<var name="i_rainnc"/>
			<var name="rainnc"/>
			<var name="precipw"/>
			<var name="cuprec"/>
			<var name="i_rainc"/>
			<var name="rainc"/>
			<var name="kpbl"/>
			<var name="hpbl"/>
			<var name="hfx"/>
			<var name="qfx"/>
			<var name="cd"/>
			<var name="cda"/>
			<var name="ck"/>
			<var name="cka"/>
			<var name="lh"/>
			<var name="u10"/>
			<var name="v10"/>
			<var name="q2"/>
			<var name="t2m"/>
			<var name="th2m"/>
			<var name="gsw"/>
			<var name="glw"/>
			<var name="acsnow"/>
			<var name="pin"/>
			<var name="ozmixm"/>
			<var name="mminlu"/>
			<var name="isice_lu"/>
			<var name="iswater_lu"/>
			<var name="xland"/>
			<var name="skintemp"/>
			<var name="snow"/>
			<var name="snowh"/>
			<var name="sst"/>
			<var name="vegfra"/>
			<var name="xice"/>
			<var name="sh2o"/>
			<var name="smois"/>
			<var name="tslb"/>
		</stream>

		<stream name="diagnostics" 
                        type="output" 
                        filename_template="diag.$Y-$M-$D_$h.$m.$s.nc" 
                        output_interval="3:00:00"
                        runtime_format="separate_file">

			<var name="initial_time"/>
			<var name="xtime"/>
			<var name="olrtoa"/>
			<var name="rainc"/>
			<var name="rainnc"/>
			<var name="refl10cm_max"/>
			<var name="refl10cm_1km"/>
			<var name="refl10cm_1km_max"/>
			<var name="precipw"/>
			<var name="u10"/>
			<var name="v10"/>
			<var name="q2"/>
			<var name="t2m"/>
			<var name="th2m"/>

                        <!-- Begin isobaric diagnostics defined in diagnostics/Registry_isobaric.xml -->
			<var name="mslp"/>
			<var name="relhum_200hPa"/>
			<var name="relhum_250hPa"/>
			<var name="relhum_500hPa"/>
			<var name="relhum_700hPa"/>
			<var name="relhum_850hPa"/>
			<var name="relhum_925hPa"/>
			<var name="dewpoint_200hPa"/>
			<var name="dewpoint_250hPa"/>
			<var name="dewpoint_500hPa"/>
			<var name="dewpoint_700hPa"/>
			<var name="dewpoint_850hPa"/>
			<var name="dewpoint_925hPa"/>
			<var name="temperature_200hPa"/>
			<var name="temperature_250hPa"/>
			<var name="temperature_500hPa"/>
			<var name="temperature_700hPa"/>
			<var name="temperature_850hPa"/>
			<var name="temperature_925hPa"/>
			<var name="height_200hPa"/>
			<var name="height_250hPa"/>
			<var name="height_500hPa"/>
			<var name="height_700hPa"/>
			<var name="height_850hPa"/>
			<var name="height_925hPa"/>
			<var name="uzonal_200hPa"/>
			<var name="uzonal_250hPa"/>
			<var name="uzonal_500hPa"/>
			<var name="uzonal_700hPa"/>
			<var name="uzonal_850hPa"/>
			<var name="uzonal_925hPa"/>
			<var name="umeridional_200hPa"/>
			<var name="umeridional_250hPa"/>
			<var name="umeridional_500hPa"/>
			<var name="umeridional_700hPa"/>
			<var name="umeridional_850hPa"/>
			<var name="umeridional_925hPa"/>
			<var name="w_200hPa"/>
			<var name="w_250hPa"/>
			<var name="w_500hPa"/>
			<var name="w_700hPa"/>
			<var name="w_850hPa"/>
			<var name="w_925hPa"/>
			<var name="vorticity_200hPa"/>
			<var name="vorticity_250hPa"/>
			<var name="vorticity_500hPa"/>
			<var name="vorticity_700hPa"/>
			<var name="vorticity_850hPa"/>
			<var name="vorticity_925hPa"/>
			<var name="t_isobaric"/>
			<var name="t_iso_levels"/>
			<var name="z_isobaric"/>
			<var name="z_iso_levels"/>
			<var name="meanT_500_300"/>
                        <!-- End isobaric diagnostics defined in diagnostics/Registry_isobaric.xml -->

                        <!-- Begin convective diagnostics defined in diagnostics/Registry_convective.xml -->
                        <var name="cape"/>
                        <var name="cin"/>
                        <var name="lcl"/>
                        <var name="lfc"/>
                        <var name="srh_0_1km"/>
                        <var name="srh_0_3km"/>
                        <var name="uzonal_surface"/>
                        <var name="uzonal_1km"/>
                        <var name="uzonal_6km"/>
                        <var name="umeridional_surface"/>
                        <var name="umeridional_1km"/>
                        <var name="umeridional_6km"/>
                        <var name="temperature_surface"/>
                        <var name="dewpoint_surface"/>
			<var name="updraft_helicity_max"/>
			<var name="w_velocity_max"/>
			<var name="wind_speed_level1_max"/>
                        <!-- End convective diagnostics defined in diagnostics/Registry_convective.xml -->

			<var name="t_oml"/>
			<var name="t_oml_initial"/>
			<var name="t_oml_200m_initial"/>
			<var name="h_oml"/>
			<var name="h_oml_initial"/>
			<var name="hu_oml"/>
			<var name="hv_oml"/>
		</stream>

		<stream name="surface" 
                        type="input" 
                        filename_template="x1.40962.sfc_update.nc" 
                        input_interval="none"
                        filename_interval="none"
                        runtime_format="separate_file">

			<var name="sst"/>
			<var name="xice"/>
		</stream>

	        <stream name="iau" 
                        type="input" 
                        filename_template="x1.40962.AmB.$Y-$M-$D_$h.$m.$s.nc" 
                        input_interval="initial_only"
                        filename_interval="none"
                        immutable="true"
                        packages="iau">

			<var name="xtime"/>
			<var_struct name="tend_iau"/>
		</stream>

                <stream name="lbc_in"
                        type="input"
                        filename_template="lbc.$Y-$M-$D_$h.$m.$s.nc"
                        filename_interval="input_interval"
                        input_interval="3:00:00" 
                        runtime_format="single_file"
                        immutable="true"
                        packages="limited_area">

                        <var name="lbc_u" />
                        <var name="lbc_w" />
                        <var name="lbc_rho" />
                        <var name="lbc_theta" />
                        <var_array name="lbc_scalars" />

                </stream>
	</streams>


<!-- **************************************************************************************** -->
<!-- ************************************** Variables *************************************** -->
<!-- **************************************************************************************** -->

        <var_struct name="mesh" time_levs="1">

                <!-- horizontal grid structure -->
                <var name="latCell" type="real" dimensions="nCells" units="rad"
                     description="Latitude of cells"/>

                <var name="lonCell" type="real" dimensions="nCells" units="rad"
                     description="Longitude of cells"/>

                <var name="xCell" type="real" dimensions="nCells" units="m"
                     description="Cartesian x-coordinate of cells"/>

                <var name="yCell" type="real" dimensions="nCells" units="m"
                     description="Cartesian y-coordinate of cells"/>

                <var name="zCell" type="real" dimensions="nCells" units="m"
                     description="Cartesian z-coordinate of cells"/>

                <var name="indexToCellID" type="integer" dimensions="nCells" units="-"
                     description="Mapping from local array index to global cell ID"/>

                <var name="latEdge" type="real" dimensions="nEdges" units="rad"
                     description="Latitude of edges"/>

                <var name="lonEdge" type="real" dimensions="nEdges" units="rad"
                     description="Longitude of edges"/>

                <var name="xEdge" type="real" dimensions="nEdges" units="m"
                     description="Cartesian x-coordinate of edges"/>

                <var name="yEdge" type="real" dimensions="nEdges" units="m"
                     description="Cartesian y-coordinate of edges"/>

                <var name="zEdge" type="real" dimensions="nEdges" units="m"
                     description="Cartesian z-coordinate of edges"/>

                <var name="indexToEdgeID" type="integer" dimensions="nEdges" units="-"
                     description="Mapping from local array index to global edge ID"/>

                <var name="latVertex" type="real" dimensions="nVertices" units="rad"
                     description="Latitude of vertices"/>

                <var name="lonVertex" type="real" dimensions="nVertices" units="rad"
                     description="Longitude of vertices"/>

                <var name="xVertex" type="real" dimensions="nVertices" units="m"
                     description="Cartesian x-coordinate of vertices"/>

                <var name="yVertex" type="real" dimensions="nVertices" units="m"
                     description="Cartesian y-coordinate of vertices"/>

                <var name="zVertex" type="real" dimensions="nVertices" units="m"
                     description="Cartesian z-coordinate of vertices"/>

                <var name="indexToVertexID" type="integer" dimensions="nVertices" units="-"
                     description="Mapping from local array index to global vertex ID"/>

                <var name="cellsOnEdge" type="integer" dimensions="TWO nEdges" units="-"
                     description="IDs of cells divided by an edge"/>

                <var name="nEdgesOnCell" type="integer" dimensions="nCells" units="-"
                     description="Number of edges forming the boundary of a cell"/>

                <var name="nEdgesOnEdge" type="integer" dimensions="nEdges" units="-"
                     description="Number of edges involved in reconstruction of tangential velocity for an edge"/>

                <var name="edgesOnCell" type="integer" dimensions="maxEdges nCells" units="-"
                     description="IDs of edges forming the boundary of a cell"/>

                <var name="edgesOnEdge" type="integer" dimensions="maxEdges2 nEdges" units="-"
                     description="IDs of edges involved in reconstruction of tangential velocity for an edge"/>

                <var name="weightsOnEdge" type="real" dimensions="maxEdges2 nEdges" units="unitless"
                     description="Weights used in reconstruction of tangential velocity for an edge"/>

                <var name="dvEdge" type="real" dimensions="nEdges" units="m"
                     description="Spherical distance between vertex endpoints of an edge"/>

                <var name="invDvEdge" type="real" dimensions="nEdges" units="m^{-1}"
                     description="Inverse distance between vertex endpoints of an edge"/>

                <var name="dcEdge" type="real" dimensions="nEdges" units="m"
                     description="Spherical distance between cells separated by an edge"/>

                <var name="invDcEdge" type="real" dimensions="nEdges" units="m^{-1}"
                     description="Inverse distance between cells separated by an edge"/>

                <var name="angleEdge" type="real" dimensions="nEdges" units="rad"
                     description="Angle between local north and the positive tangential direction of an edge"/>

                <var name="areaCell" type="real" dimensions="nCells" units="m^2"
                     description="Spherical area of a Voronoi cell"/>

                <var name="invAreaCell" type="real" dimensions="nCells" units="m^{-2}"
                     description="Inverse of Voronoi cell area"/>

                <var name="areaTriangle" type="real" dimensions="nVertices" units="m^2"
                     description="Spherical area of a Delaunay triangle"/>

                <var name="invAreaTriangle" type="real" dimensions="nVertices" units="m^{-2}"
                     description="Inverse area of a Delaunay triangle"/>

                <var name="edgeNormalVectors" type="real" dimensions="R3 nEdges" units="unitless"
                     description="Cartesian components of the vector normal to an edge and tangential to the surface of the sphere"/>

                <var name="localVerticalUnitVectors" type="real" dimensions="R3 nCells" units="unitless"
                     description="Cartesian components of the vector pointing in the local vertical direction for a cell"/>

                <var name="cellTangentPlane" type="real" dimensions="R3 TWO nCells" units="unitless"
                     description="Components of a pair of vectors defining the tangent plane at a cell"/>

                <var name="cellsOnCell" type="integer" dimensions="maxEdges nCells" units="-"
                     description="IDs of cells neighboring a cell"/>

                <var name="verticesOnCell" type="integer" dimensions="maxEdges nCells" units="-"
                     description="IDs of vertices (corner points) of a cell"/>

                <var name="verticesOnEdge" type="integer" dimensions="TWO nEdges" units="-"
                     description="IDs of the two vertex endpoints of an edge"/>

                <var name="edgesOnVertex" type="integer" dimensions="vertexDegree nVertices" units="-"
                     description="IDs of the edges that meet at a vertex"/>

                <var name="cellsOnVertex" type="integer" dimensions="vertexDegree nVertices" units="-"
                     description="IDs of the cells that meet at a vertex"/>

                <var name="kiteAreasOnVertex" type="real" dimensions="vertexDegree nVertices" units="m^2"
                     description="Intersection areas between primal (Voronoi) and dual (triangular) mesh cells"/>

                <var name="fEdge" type="real" dimensions="nEdges" units="unitless"
                     description="Coriolis parameter at an edge"/>

                <var name="fVertex" type="real" dimensions="nVertices" units="unitless"
                     description="Coriolis parameter at a vertex"/>

                <var name="meshDensity" type="real" dimensions="nCells" units="unitless"
                     description="Mesh density function (used when generating the mesh) evaluated at a cell"/>

                <var name="meshScalingDel2" type="real" dimensions="nEdges" units="unitless"
                     description="Scaling coefficient for $\nabla^2$ eddy viscosity"/>

                <var name="meshScalingDel4" type="real" dimensions="nEdges" units="unitless"
                     description="Scaling coefficient for $\nabla^4$ eddy hyper-viscosity"/>

                <var name="meshScalingRegionalCell" type="real" dimensions="nCells" units="unitless"
                     description="Cell-centered Scaling coefficient for relaxation zone"/>

                <var name="meshScalingRegionalEdge" type="real" dimensions="nEdges" units="unitless"
                     description="Edge-centered Scaling coefficient for relaxation zone"/>

                <var name="edgesOnVertex_sign" type="real" dimensions="vertexDegree nVertices" units="-"
                     description="Sign for edges incident with a vertex: positive for positive inward tengential velocity"/>

                <var name="edgesOnCell_sign" type="real" dimensions="maxEdges nCells" units="-"
                     description="Sign for edges surrounding a cell: positive for positive outward normal velocity"/>

                <var name="kiteForCell" type="integer" dimensions="maxEdges nCells" units="-"
                     description="Index of kite in kiteAreasOnVertex that lies within a cell for each of verticesOnCell"/>

                <!-- coefficients for vertical extrapolation to the surface -->
                <var name="cf1" type="real" dimensions="" units="unitless"
                     description="Surface interpolation weight for level k=1 value"/>

                <var name="cf2" type="real" dimensions="" units="unitless"
                     description="Surface interpolation weight for level k=2 value"/>

                <var name="cf3" type="real" dimensions="" units="unitless"
                     description="Surface interpolation weight for level k=3 value"/>

                <!-- description of the vertical grid structure -->
                <var name="zgrid" type="real" dimensions="nVertLevelsP1 nCells" units="m MSL"
                     description="Geometric height of layer interfaces"/>

                <var name="rdzw" type="real" dimensions="nVertLevels" units="unitless"
                     description="Reciprocal dzw"/>

                <var name="dzu" type="real" dimensions="nVertLevels" units="unitless"
                     description="d(zeta) at w levels"/>

                <var name="rdzu" type="real" dimensions="nVertLevels" units="unitless"
                     description="Reciprocal dzu"/>

                <var name="fzm" type="real" dimensions="nVertLevels" units="unitless"
                     description="Weight for linear interpolation to w(k) point for u(k) level variable"/>

                <var name="fzp" type="real" dimensions="nVertLevels" units="unitless"
                     description="Weight for linear interpolation to w(k) point for u(k-1) level variable"/>

                <var name="zxu" type="real" dimensions="nVertLevels nEdges" units="unitless"
                     description="dz/dx on horizontal coordinate surfaces at u levels"/>

                <var name="zz" type="real" dimensions="nVertLevels nCells" units="unitless"
                     description="d(zeta)/dz, vertical metric term"/>

                <var name="zb" type="real" dimensions="nVertLevelsP1 TWO nEdges" units="unitless"
                     description="Coefficients for contribution from u to omega diagnosis, edge-oriented"/>

                <var name="zb3" type="real" dimensions="nVertLevelsP1 TWO nEdges" units="unitless"
                     description="Coefficients for 3rd-order correction to contribution from u to omega diagnosis, edge-oriented"/>

                <var name="zb_cell" type="real" dimensions="nVertLevelsP1 maxEdges nCells" units="unitless"
                     description="Coefficients for contribution from u to omega diagnosis, cell-oriented"/>

                <var name="zb3_cell" type="real" dimensions="nVertLevelsP1 maxEdges nCells" units="unitless"
                     description="Coefficients for 3rd-order correction to contribution from u to omega diagnosis, cell-oriented"/>

                <!-- W-Rayleigh damping coefficients -->
                <var name="dss" type="real" dimensions="nVertLevels nCells" units="unitless"
                     description="w-damping coefficient"/>

                <!-- Reference profiles -->
                <var name="u_init" type="real" dimensions="nVertLevels" units="m s^{-1}"
                     description="u reference profile"/>

                <var name="v_init" type="real" dimensions="nVertLevels" units="m s^{-1}"
                     description="v reference profile"/>

                <var name="t_init" type="real" dimensions="nVertLevels nCells" units="K"
                     description="theta reference profile"/>

                <var name="qv_init" type="real" dimensions="nVertLevels" units="kg kg^{-1}"
                     description="qv reference profile"/>

                <!-- Space needed for advection -->
                <var name="deriv_two" type="real" dimensions="FIFTEEN TWO nEdges" units="unitless"
                     description="weights for cell-centered second derivative, normal to edge, for transport scheme"/>

                <var name="adv_coefs" type="real" dimensions="FIFTEEN nEdges" units="unitless"
                     description="Weighting coefficents used for reconstructing cell-based foelds at edges"/>

                <var name="adv_coefs_3rd" type="real" dimensions="FIFTEEN nEdges" units="unitless"
                     description="Weighting coefficents used for reconstructing cell-based foelds at edges"/>

                <var name="advCellsForEdge" type="integer" dimensions="FIFTEEN nEdges" units="-"
                     description="Cells used to reconstruct a cell-based field at an edge"/>

                <var name="nAdvCellsForEdge" type="integer" dimensions="nEdges" units="-"
                     description="Number of cells used to reconstruct a cell-based field at an edge"/>

                <!-- Space needed for deformation calculation weights -->
                <var name="defc_a" type="real" dimensions="maxEdges nCells" units="unitless"
                     description="Coefficients for computing the off-diagonal components of the horizontal deformation"/>

                <var name="defc_b" type="real" dimensions="maxEdges nCells" units="unitless"
                     description="Coefficients for computing the diagonal components of the horizontal deformation"/>

                <!-- Arrays required for reconstruction of velocity field -->
                <var name="coeffs_reconstruct" type="real" dimensions="R3 maxEdges nCells" units="unitless"
                     description="Coefficients to reconstruct velocity vectors at cell centers"/>

                <var name="east" type="real" dimensions="R3 nCells" units="unitless"
                     description="Cartesian components of the local unit vector pointing east"/>

                <var name="north" type="real" dimensions="R3 nCells" units="unitless"
                     description="Cartesian components of the unit vector pointing north"/>

                <var name="bdyMaskCell" type="integer" dimensions="nCells" default_value="0"
                     units="-"
                     description="Limited-area specified/relaxation zone index for cells"/>

                <var name="bdyMaskEdge" type="integer" dimensions="nEdges" default_value="0"
                     units="-"
                     description="Limited-area specified/relaxation zone index for edges"/>

                <var name="bdyMaskVertex" type="integer" dimensions="nVertices" default_value="0"
                     units="-"
                     description="Limited-area specified/relaxation zone index for vertices"/>

                <var name="specZoneMaskCell" type="real" dimensions="nCells" default_value="0.0"
                     units="-"
                     description="0/1 mask on cells, defined as 1 for cells in the limited-area specified zone"/>

                <var name="specZoneMaskEdge" type="real" dimensions="nEdges" default_value="0.0"
                     units="-"
                     description="0/1 mask on edges, defined as 1 for edges in the limited-area specified zone"/>

                <var name="specZoneMaskVertex" type="real" dimensions="nVertices" default_value="0.0"
                     units="-"
                     description="0/1 mask on vertices, defined as 1 for vertices in the limited-area specified zone"/>

                <var name="nearestRelaxationCell" type="integer" dimensions="nCells" units="-"
                     description="For cells in the specified zone, gives the index of the nearest cell in the relaxation zone"/>

        </var_struct>

        <var_struct name="state" time_levs="2">

                <var name="initial_time" type="text" dimensions="" units="YYYY-MM-DD_hh:mm:ss"
                     description="Model initialization time"/>

                <var name="xtime" type="text" dimensions="Time" units="YYYY-MM-DD_hh:mm:ss"
                     description="Model valid time"/>

                <!-- Prognostic variables: read from input, saved in restart, and written to output -->
                <var name="u" type="real" dimensions="nVertLevels nEdges Time" units="m s^{-1}"
                     description="Horizontal normal velocity at edges"/>

                <var name="w" type="real" dimensions="nVertLevelsP1 nCells Time" units="m s^{-1}"
                     description="Vertical velocity at vertical cell faces"/>

                <var name="rho_zz" type="real" dimensions="nVertLevels nCells Time" units="kg m^{-3}"
                     description="Dry air density divided by d(zeta)/dz"/>

                <var name="theta_m" type="real" dimensions="nVertLevels nCells Time" units="K"
                     description="Moist potential temperature: theta*(1+q_v*R_v/R_d)"/>

                <var_array name="scalars" type="real" dimensions="nVertLevels nCells Time">
                        <var name="qv" array_group="moist" units="kg kg^{-1}"
                             description="Water vapor mixing ratio"/>

                        <var name="qc" array_group="moist" units="kg kg^{-1}"
                             description="Cloud water mixing ratio"
                             packages="bl_mynn_in;bl_ysu_in;cu_tiedtke_in;mp_kessler_in;mp_thompson_in;mp_wsm6_in"/>

                        <var name="qr" array_group="moist" units="kg kg^{-1}"
                             description="Rain water mixing ratio"
                             packages="mp_kessler_in;mp_thompson_in;mp_wsm6_in"/>

                        <var name="qi" array_group="moist" units="kg kg^{-1}"
                             description="Ice mixing ratio"
                             packages="bl_mynn_in;bl_ysu_in;cu_tiedtke_in;mp_thompson_in;mp_wsm6_in"/>

                        <var name="qs" array_group="moist" units="kg kg^{-1}"
                             description="Snow mixing ratio"
                             packages="mp_thompson_in;mp_wsm6_in"/>

                        <var name="qg" array_group="moist" units="kg kg^{-1}"
                             description="Graupel mixing ratio"
                             packages="mp_thompson_in;mp_wsm6_in"/>

                        <var name="ni" array_group="number" units="nb kg^{-1}"
                             description="Cloud ice number concentration"
                             packages="bl_mynn_in;mp_thompson_in"/>

                        <var name="nr" array_group="number" units="nb kg^{-1}"
                             description="Rain number concentration"
                             packages="mp_thompson_in"/>
                </var_array>

                <var_array name="aerosols" type="real" dimensions="nAerLevels nCells Time">
                        <var name="sul"     array_group="aer_cam" units="kg m^{-3}"
                             description="Sulfate soluble (SUL) aerosol concentration"/>

                        <var name="sslt"    array_group="aer_cam" units="kg m^{-3}"
                             description="Sea-salt (SSLT) aerosol concentration"/>

                        <var name="dust1"   array_group="aer_cam" units="kg m^{-3}"
                             description="Dust type 1 (DUST1) aerosol concentration"/>

                        <var name="dust2"   array_group="aer_cam" units="kg m^{-3}"
                             description="Dust type 2 (DUST2) aerosol concentration"/>

                        <var name="dust3"   array_group="aer_cam" units="kg m^{-3}"
                             description="Dust type 3 (DUST3) aerosol concentration"/>

                        <var name="dust4"   array_group="aer_cam" units="kg m^{-3}"
                             description="Dust type 4 (DUST4) aerosol concentration"/>

                        <var name="ocpho"   array_group="aer_cam" units="kg m^{-3}"
                             description="Hydrophobic organic carbon (OCPHO) aerosol concentration"/>

                        <var name="bcpho"   array_group="aer_cam" units="kg m^{-3}"
                             description="Hydrophobic black carbon (BCPHO) aerosol concentration"/>

                        <var name="ocphi"   array_group="aer_cam" units="kg m^{-3}"
                             description="Hydrophilic organic carbon (OCPHI) aerosol concentration"/>

                        <var name="bcphi"   array_group="aer_cam" units="kg m^{-3}"
                             description="Hydrophilic black carbon (BCPHI) aerosol concentration"/>

                        <var name="bg"      array_group="aer_cam" units="kg m^{-3}"
                             description="Background (BG) aerosol concentration"/>

                        <var name="volc"    array_group="aer_cam" units="kg m^{-3}"
                             description="Volcanic (VOLC) aerosol concentration"/>

                </var_array>
        </var_struct>

        <var_struct name="diag" time_levs="1">

                <!-- coefficients for the vertical tridiagonal solve -->
                <!-- Note:  these could be local but...              -->
                <var name="cofrz" type="real" dimensions="nVertLevels Time" units="s m^{-1}"
                     description="coefficient for implicit contribution of Omega to density update"/>

                <var name="cofwr" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1}"
                     description="coefficient for implicit contribution of density to the vertical velocity update"/>

                <var name="cofwz" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1} K^{-1}"
                     description="coefficient for implicit contribution of density to the vertical velocity update"/>

                <var name="coftz" type="real" dimensions="nVertLevelsP1 nCells Time" units="s K"
                     description="coefficient for implicit contribution of omega vertical derivative to the theta_m update"/>

                <var name="cofwt" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1} K^{-1}"
                     description="coefficient for implicit contribution of density to the vertical velocity update"/>

                <var name="a_tri" type="real" dimensions="nVertLevels nCells Time" units="unitless"
                     description="implicit tridiagonal solve coefficients"/>

                <var name="alpha_tri" type="real" dimensions="nVertLevels nCells Time" units="unitless"
                     description="implicit tridiagonal solve coefficients"/>

                <var name="gamma_tri" type="real" dimensions="nVertLevels nCells Time" units="unitless"
                     description="implicit tridiagonal solve coefficients"/>

                <!-- state variables diagnosed from prognostic state -->
                <var name="pressure_p" type="real" dimensions="nVertLevels nCells Time" units="Pa"
                     description="Perturbation pressure"/>

                <!-- Diagnostic fields: only written to output                                                           -->
                <!-- NOTE: added the "r" option to rho,theta,uReconstructZonal,and uReconstructMeridional for use of the -->
                <!-- non-hydrostatic dynamical core in a data assimilation framework. NOTE that the "r" option is not    -->
                <!-- needed for those 4 variables to get bit for bit restart capabilities, otherwise.                    -->
                <var name="rho" type="real" dimensions="nVertLevels nCells Time" units="kg m^{-3}"
                     description="Dry air density"/>

                <var name="theta" type="real" dimensions="nVertLevels nCells Time" units="K"
                     description="Potential temperature"/>

                <var name="temperature" type="real" dimensions="nVertLevels nCells Time" units="K"
                     description="temperature"
                     packages="jedi_da"/>

                <var name="relhum" type="real" dimensions="nVertLevels nCells Time" units="percent"
                     description="Relative humidity"/>

                <var name="spechum" type="real" dimensions="nVertLevels nCells Time" units="kg kg^{-1}"
                     description="Specific humidity"
                     packages="jedi_da"/>

                <var name="v" type="real" dimensions="nVertLevels nEdges Time" units="m s^{-1}"
                     description="Horizontal tangential velocity at edges"/>

                <var name="divergence" type="real" dimensions="nVertLevels nCells Time" units="s^{-1}"
                     description="Horizontal velocity divergence at cell center"/>

                <var name="vorticity" type="real" dimensions="nVertLevels nVertices Time" units="s^{-1}"
                     description="Relative vorticity at vertices"/>

                <var name="pv_edge" type="real" dimensions="nVertLevels nEdges Time" units="s^{-1} kg^{-1} m^3"
                     description="absolute vorticity/rho_zz averaged to the cell edge from the vertices"/>

                <var name="rho_edge" type="real" dimensions="nVertLevels nEdges Time" units="kg m^{-3}"
                     description="rho_zz averaged from cell centers to the cell edge"/>

                <var name="ke" type="real" dimensions="nVertLevels nCells Time" units="m^2 s^{-2}"
                     description="Kinetic energy at a cell center"/>

                <var name="pv_vertex" type="real" dimensions="nVertLevels nVertices Time" units="s^{-1} kg^{-1} m^3"
                     description="absolute vorticity/rho_zz at a vertex"/>

                <var name="pv_cell" type="real" dimensions="nVertLevels nCells Time" units="s^{-1} kg^{-1} m^3"
                     description="absolute vorticity/rho_zz averaged to the cell center from the vertices"/>

                <!-- reconstructed horizontal velocity vectors at cell centers -->
                <var name="uReconstructX" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1}"
                     description="Cartesian x-component of reconstructed horizontal velocity at cell centers"/>

                <var name="uReconstructY" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1}"
                     description="Cartesian y-component of reconstructed horizontal velocity at cell centers"/>

                <var name="uReconstructZ" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1}"
                     description="Cartesian z-component of reconstructed horizontal velocity at cell centers"/>

                <var name="uReconstructZonal" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1}"
                     description="Zonal component of reconstructed horizontal velocity at cell centers"/>

                <var name="uReconstructMeridional" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1}"
                     description="Meridional component of reconstructed horizontal velocity at cell centers"/>

                <!-- Other diagnostic variables -->

                <var name="rv" type="real" dimensions="nVertLevels nEdges Time" units="???"
                     description="???"/>

                <var name="circulation" type="real" dimensions="nVertLevels nVertices Time" units="m^2 s^{-1}"
                     description="Horizontal circulation at vertices"/>

                <var name="gradPVt" type="real" dimensions="nVertLevels nEdges Time" units="???"
                     description="Gradient in the tangential direction of PV at edge locations"/>

                <var name="gradPVn" type="real" dimensions="nVertLevels nEdges Time" units="???"
                     description="Gradient in the normal direction of PV at edge locations"/>

                <var name="h_divergence" type="real" dimensions="nVertLevels nCells Time" units="???"
                     description="???"/>

                <var name="exner" type="real" dimensions="nVertLevels nCells Time" units="unitless"
                     description="Exner function"/>

                <var name="exner_base" type="real" dimensions="nVertLevels nCells Time" units="unitless"
                     description="Base-state Exner function"/>

                <var name="rtheta_base" type="real" dimensions="nVertLevels nCells Time" units="kg K m^{-3}"
                     description="reference state rho*theta/zz"/>

                <var name="pressure" type="real" dimensions="nVertLevels nCells Time" units="Pa"
                     description="Pressure"/>

                <var name="pressure_base" type="real" dimensions="nVertLevels nCells Time" units="Pa"
                     description="Base state pressure"/>

                <var name="rho_base" type="real" dimensions="nVertLevels nCells Time" units="kg m^{-3}"
                     description="Base state dry air density"/>

                <var name="theta_base" type="real" dimensions="nVertLevels nCells Time" units="K"
                     description="Base state potential temperature"/>

                <var name="rho_zz_old_split" type="real" dimensions="nVertLevels nCells Time" units="kg m^{-3}"
                     description="rho/zz"/>

                <var name="ruAvg" type="real" dimensions="nVertLevels nEdges Time" units="kg m^{-2} s^{-1}"
                     description="time-averaged rho*u/zz used in scalar transport"/>

                <var name="wwAvg" type="real" dimensions="nVertLevelsP1 nCells Time" units="kg m^{-2} s^{-1}"
                     description="time-averaged rho*omega/zz used in scalar transport"/>

                <var name="ruAvg_split" type="real" dimensions="nVertLevels nEdges Time" units="kg m^{-2} s^{-1}"
                     description="time-averaged rho*u/zz used in scalar transport"/>

                <var name="wwAvg_split" type="real" dimensions="nVertLevelsP1 nCells Time" units="kg m^{-2} s^{-1}"
                     description="time-averaged rho*omega/zz used in scalar transport"/>

                <var name="cqu" type="real" dimensions="nVertLevels nEdges Time" units="unitless"
                     description="rho_d/rho_m at cell edge (u points)"/>

                <var name="cqw" type="real" dimensions="nVertLevels nCells Time" units="unitless"
                     description="rho_d/rho_m at w points"/>

                <!-- coupled variables needed by solver, but not output -->
                <var name="ru" type="real" dimensions="nVertLevels nEdges Time" units="kg m^{-2} s^{-1}"
                     description="horizontal momentum at cell edge (rho*u/zz)"/>

                <var name="ru_p" type="real" dimensions="nVertLevels nEdges Time" units="kg m^{-2} s^{-1}"
                     description="acoustic perturbation horizontal momentum at cell edge  (rho*u/zz)"/>

                <var name="ru_save" type="real" dimensions="nVertLevels nEdges Time" units="kg m^{-2} s^{-1}"
                     description="predicted value of horizontal momentum, saved before acoustic steps"/>

                <var name="rw" type="real" dimensions="nVertLevelsP1 nCells Time" units="kg m^{-2} s^{-1}"
                     description="rho*omega/zz carried at w points"/>

                <var name="rw_p" type="real" dimensions="nVertLevelsP1 nCells Time" units="kg m^{-2} s^{-1}"
                     description="acoustic perturbation rho*omega/zz carried at w points"/>

                <var name="rw_save" type="real" dimensions="nVertLevelsP1 nCells Time" units="kg m^{-2} s^{-1}"
                     description="predicted value of rho*omega/zz, saved before acoustic steps"/>

                <var name="rtheta_p" type="real" dimensions="nVertLevels nCells Time" units="kg K m^{-3}"
                     description="rho*theta_m/zz perturbation from the reference state value"/>

                <var name="rtheta_pp" type="real" dimensions="nVertLevels nCells Time" units="kg K m^{-3}"
                     description="rho*theta_m/zz perturbation from rtheta_p"/>

                <var name="rtheta_p_save" type="real" dimensions="nVertLevels nCells Time" units="kg K m^{-3}"
                     description="predicted value rtheta_p, saved before acoustic steps"/>

                <var name="rtheta_pp_old" type="real" dimensions="nVertLevels nCells Time" units="kg K m^{-3}"
                     description="old time level values of rho*theta_m/zz perturbation from rtheta_p, used in 3D divergence damping"/>

                <var name="rho_p" type="real" dimensions="nVertLevels nCells Time" units="kg m^{-3}"
                     description="rho/zz perturbation from the reference state value, advanced over acoustic steps"/>

                <var name="rho_pp" type="real" dimensions="nVertLevels nCells Time" units="kg m^{-3}"
                     description="rho/zz perturbation from rho_pp, advanced over acoustic steps"/>

                <var name="rho_p_save" type="real" dimensions="nVertLevels nCells Time" units="kg m^{-3}"
                     description="predicted value rho_p, saved before acoustic steps"/>

                <var name="kdiff" type="real" dimensions="nVertLevels nCells Time" units="m^2 s^{-1}"
                     description="Smagorinsky horizontal eddy viscosity"/>

                <var name="tend_rtheta_adv" type="real" dimensions="nVertLevels nCells Time" units="kg K m^{-3} s^{-1}"
                     description="flux divergence for rho*theta_m/zz, used in the Tiedtke convective parameterization"/>

                <var name="surface_pressure" type="real" dimensions="nCells Time" units="Pa"
                     description="Diagnosed surface pressure"/>

        </var_struct>

        <var_struct name="tend" time_levs="1">

                
                <!-- tendencies for prognostic variables -->
                <var name="tend_u" name_in_code="u" type="real" dimensions="nVertLevels nEdges Time" units="m s^{-2}"
                     description="Tendency of u from dynamics"/>

                <var name="tend_w" name_in_code="w" type="real" dimensions="nVertLevelsP1 nCells Time" units="m s^{-2}"
                     description="Tendency of w from dynamics"/>

                <var name="tend_rho" name_in_code="rho_zz" type="real" dimensions="nVertLevels nCells Time" units="kg m^{-3} s^{-1}"
                     description="Tendency of dry density from dynamics"/>

                <var name="tend_theta" name_in_code="theta_m" type="real" dimensions="nVertLevels nCells Time" units="kg K m^{-3} s^{-1}"
                     description="tendency of coupled potential temperature rho*theta_m/zz from dynamics and physics, updated each RK step"/>

                <var name="rt_diabatic_tend" type="real" dimensions="nVertLevels nCells Time" units="kg K s^{-1}"
                     description="Tendency of coupled potential temperature from physics"/>

                <var name="euler_tend_u" name_in_code="u_euler" type="real" dimensions="nVertLevels nEdges Time" units="m s^{-2}"
                     description="Tendency of u from dynamics"/>

                <var name="euler_tend_w" name_in_code="w_euler" type="real" dimensions="nVertLevelsP1 nCells Time" units="m s^{-2}"
                     description="Tendency of w from dynamics"/>

                <var name="euler_tend_theta" name_in_code="theta_euler" type="real" dimensions="nVertLevels nCells Time" units="kg K m^{-3} s^{-1}"
                     description="tendency of coupled potential temperature rho*theta_m/zz from dynamics and physics that does not change over a Runge-Kutta timestep (it excludes the flux divergence)"/>

                <var name="tend_w_pgf" name_in_code="w_pgf" type="real" dimensions="nVertLevelsP1 nCells Time" units="m s^{-2}"
                     description="Tendency of w due to pressure gradient force"/>

                <var name="tend_w_buoy" name_in_code="w_buoy" type="real" dimensions="nVertLevelsP1 nCells Time" units="m s^{-2}"
                     description="Tendency of w due to buoyancy force"/>

                <var name="tend_sfc_pressure" type="real" dimensions="nCells Time" units="Pa s^{-1}"
                     description="Tendency of surface pressure"/>

                <!-- scalar tendencies -->
                <var_array name="scalars_tend" type="real" dimensions="nVertLevels nCells Time">
                        <var name="tend_qv" name_in_code="qv" array_group="moist" units="kg m^{-3} s^{-1}"
                             description="Tendency of water vapor mass per unit volume divided by d(zeta)/dz"/>

                        <var name="tend_qc" name_in_code="qc" array_group="moist" units="kg m^{-3} s^{-1}"
                             description="Tendency of cloud water mass per unit volume divided by d(zeta)/dz"
                             packages="bl_mynn_in;bl_ysu_in;cu_tiedtke_in;mp_kessler_in;mp_thompson_in;mp_wsm6_in"/>

                        <var name="tend_qr" name_in_code="qr" array_group="moist" units="kg m^{-3} s^{-1}"
                             description="Tendency of rain water mass per unit volume divided by d(zeta)/dz"
                             packages="mp_kessler_in;mp_thompson_in;mp_wsm6_in"/>

                        <var name="tend_qi" name_in_code="qi" array_group="moist" units="kg m^{-3} s^{-1}"
                             description="Tendency of ice mass per unit volume divided by d(zeta)/dz"
                             packages="bl_mynn_in;bl_ysu_in;cu_tiedtke_in;mp_thompson_in;mp_wsm6_in"/>

                        <var name="tend_qs" name_in_code="qs" array_group="moist" units="kg m^{-3} s^{-1}"
                             description="Tendency of snow mass per unit volume divided by d(zeta)/dz"
                             packages="mp_thompson_in;mp_wsm6_in"/>

                        <var name="tend_qg" name_in_code="qg" array_group="moist" units="kg m^{-3} s^{-1}"
                             description="Tendency of graupel mass per unit volume divided by d(zeta)/dz"
                             packages="mp_thompson_in;mp_wsm6_in"/>

                        <var name="tend_ni" name_in_code="ni" array_group="number" units="nb m^{-3} s^{-1}"
                             description="Tendency of cloud ice number concentration multiplied by dry air density divided by d(zeta)/dz"
                             packages="bl_mynn_in;mp_thompson_in"/>

                        <var name="tend_nr" name_in_code="nr" array_group="number" units="nb m^{-3} s^{-1}" 
                             description="Tendency of rain number concentration multiplied by dry air density divided by d(zeta)/dz"
                             packages="mp_thompson_in"/>
                </var_array>
        </var_struct>

        <!-- ===================================================================================== -->
        <!-- Storage for lateral boundary conditions:                                              -->
        <!-- Time-level 1 contains tendencies for variables                                        -->
        <!-- Time-level 2 contains values for variables valid at the end of the boundary interval  -->
        <!-- ===================================================================================== -->
        <var_struct name="lbc" time_levs="2" packages="limited_area">
                <var name="lbc_u" type="real" dimensions="nVertLevels nEdges Time" units="m s^{-2}"
                     description="Lateral boundary tendency of u"/>

                <var name="lbc_ru" type="real" dimensions="nVertLevels nEdges Time" units="kg m^{-2} s^{-2}"
                     description="Lateral boundary tendency of rho_zz-coupled u"/>

                <var name="lbc_w" type="real" dimensions="nVertLevelsP1 nCells Time" units="m s^{-2}"
                     description="Lateral boundary tendency of w"/>

                <var name="lbc_rho" type="real" dimensions="nVertLevels nCells Time" units="kg m^{-3} s^{-1}"
                     description="Lateral boundary tendency of rho"/>

                <var name="lbc_rho_zz" type="real" dimensions="nVertLevels nCells Time" units="kg m^{-3} s^{-1}"
                     description="Lateral boundary tendency of rho_zz"/>

                <var name="lbc_rho_edge" type="real" dimensions="nVertLevels nEdges Time" units="kg m^{-3} s^{-1}"
                     description="Lateral boundary tendency of rho_zz averaged from cell centers to cell faces (edges)"/>

                <var name="lbc_theta" type="real" dimensions="nVertLevels nCells Time" units="K s^{-2}"
                     description="Lateral boundary tendency of theta"/>

                <var name="lbc_rtheta_m" type="real" dimensions="nVertLevels nCells Time" units="kg K m^{-3} s^{-2}"
                     description="Lateral boundary tendency of rho_zz-coupled theta_m"/>

                <var_array name="lbc_scalars" type="real" dimensions="nVertLevels nCells Time">
                        <var name="lbc_qv" name_in_code="qv" array_group="moist" units="kg kg^{-1} s^{-1}"
                             description="Lateral boundary tendency of water vapor mixing ratio"/>

                        <var name="lbc_qc" name_in_code="qc" array_group="moist"  packages="bl_mynn_in;cu_tiedtke_in;mp_kessler_in;mp_thompson_in;mp_wsm6_in" units="kg kg^{-1} s^{-1}"
                             description="Lateral boundary tendency of cloud water mixing ratio"/>

                        <var name="lbc_qr" name_in_code="qr" array_group="moist"  packages="mp_kessler_in;mp_thompson_in;mp_wsm6_in" units="kg kg^{-1} s^{-1}"
                             description="Lateral boundary tendency of rain water mixing ratio"/>

                        <var name="lbc_qi" name_in_code="qi" array_group="moist"  packages="bl_mynn_in;cu_tiedtke_in;mp_thompson_in;mp_wsm6_in" units="kg kg^{-1} s^{-1}"
                             description="Lateral boundary tendency of ice mixing ratio"/>

                        <var name="lbc_qs" name_in_code="qs" array_group="moist"  packages="mp_thompson_in;mp_wsm6_in" units="kg kg^{-1} s^{-1}"
                             description="Lateral boundary tendency of snow mixing ratio"/>

                        <var name="lbc_qg" name_in_code="qg" array_group="moist"  packages="mp_thompson_in;mp_wsm6_in" units="kg kg^{-1} s^{-1}"
                             description="Lateral boundary tendency of graupel mixing ratio"/>

                        <var name="lbc_nr" name_in_code="nr" array_group="number" packages="mp_thompson_in" units="m^{-3} s^{-1}"
                             description="Lateral boundary tendency of rain number concentration"/>

                        <var name="lbc_ni" name_in_code="ni" array_group="number" packages="bl_mynn_in;mp_thompson_in" units="m^{-3} s^{-1}"
                             description="Lateral boundary tendency of ice number concentration"/>
                </var_array>
        </var_struct>


<!-- ================================================================================================== -->
<!--  DECLARATIONS OF ALL PHYSICS VARIABLES (will need to be moved to a Physics Registry shared by the  -->
<!--  hydrostatic and non-hydrostatic dynamical cores):                                                 -->
<!-- ================================================================================================== -->


        <nml_record name="physics" in_defaults="true">
                <!-- NAMELIST VARIABLES ADDED FOR INITIALIZATION OF SURFACE CHARACTERISTICS: -->
                <nml_option name="input_soil_data" type="character" default_value="STAS" in_defaults="false"
                     units="-"
                     description="input soil use classification"
                     possible_values="`STAS`"/>

                <nml_option name="input_soil_temperature_lag" type="integer" default_value="140" in_defaults="false"
                     units="-"
                     description="days over which the deep soil temperature is computed using skin temperature"
                     possible_values="Positive integers"/>

                <nml_option name="num_soil_layers" type="integer" default_value="4" in_defaults="false"
                     units="-"
                     description="number of soil layers in Noah land surface scheme"
                     possible_values="Positive integers. For Noah LSM, must be set to 4."/>

                <nml_option name="months" type="integer" default_value="12" in_defaults="false"
                     units="-"
                     description="number of months per year"
                     possible_values="Positive integer values. DO NOT CHANGE."/>

                <!-- ... DIMENSION NEEDED FOR OZONE AND AEROSOLS CONCENTRATIONS IN THE CAM LONGWAVE AND SHORTWAVE -->
                <!-- ... RADIATION PARAMETERIZATIONS.                                                             -->
                <nml_option name="noznlev" type="integer" default_value="59" in_defaults="false"
                     units="-"
                     description="number of prescribed pressure levels for input climatological ozone volume mixing ratios"
                     possible_values="Positive integers"/>

                <nml_option name="naerlev" type="integer" default_value="29" in_defaults="false"
                     units="-"
                     description="number of prescribed pressure levels for input climatological aerosol mixing ratio"
                     possible_values="Positive integers"/>

                <nml_option name="camdim1" type="integer" default_value="4" in_defaults="false"
                     units="-"
                     description="dimension of CAM radiation absorption save array"
                     possible_values="Positive integers"/>

                <!-- NAMELIST VARIABLES ADDED FOR PHYSICS CONFIGURATION: -->
                
                <nml_option name="config_frac_seaice" type="logical" default_value="true" in_defaults="false"
                     units="-"
                     description="logical for configuration of fractional sea-ice"
                     possible_values=".true. for sea-ice between 0 or 1; .false. for sea-ice equal to 0 or 1 (flag)."/>

                <nml_option name="config_sfc_albedo" type="logical" default_value="true" in_defaults="false"
                     units="-"
                     description="logical for configuration of surface albedo"
                     possible_values=".true. for climatologically varying surface albedo; .false. for fixed input data"/>

                <nml_option name="config_sfc_snowalbedo" type="logical" default_value="true" in_defaults="false"
                     units="-"
                     description="logical for configuration of maximum surface albedo for snow"
                     possible_values=".true. for geographical distribution; .false. for fixed input data"/>

                <nml_option name="config_sst_update" type="logical" default_value="false"
                     units="-"
                     description="logical for configuration of sea-surface temperature"
                     possible_values=".true. for time-varying sea-surface temperatures; .false., otherwise"/>

                <nml_option name="config_sstdiurn_update" type="logical" default_value="false"
                     units="-"
                     description="logical for configuration of diurnal cycle of sea-surface temperatures"
                     possible_values=".true. for applying a diurnal cycle to sea-surface temperatures; .false., otherwise"/>

                <nml_option name="config_deepsoiltemp_update" type="logical" default_value="false"
                     units="-"
                     description="logical for configuration of deep soil temperatures"
                     possible_values=".true. for slowly time-varying deep soil temperatures; .false. otherwise"/>

                <nml_option name="config_o3climatology" type="logical" default_value="true" in_defaults="false"
                     units="-"
                     description="logical for configuration of input ozone data in RRMTG long- and short-wave radiation"
                     possible_values=".true. for using monthly-varying ozone data; .false. for using fixed vertical profile"/>

                <nml_option name="config_microp_re" type="logical" default_value="false" in_defaults="false"
                     units="-"
                     description="logical for calculation of the effective radii for cloud water, cloud ice, and snow"
                     possible_values=".true. for calculating effective radii; .false. for using defaults in RRTMG radiation"/>

                <nml_option name="config_ysu_pblmix" type="logical" default_value="false" in_defaults="false"
                     units="-"
                     description="logical for turning on/off top-down, radiation_driven mixing"
                     possible_values=".true. to turn on top-down radiation_driven mixing; .false. otherwise"/>

                <nml_option name="config_n_microp" type="integer" default_value="1" in_defaults="false"
                     units="-"
                     description="number of microphysics time-steps per physics time-steps"
                     possible_values="Positive integers"/>

                <nml_option name="config_radtlw_interval" type="character" default_value="00:30:00"
                     units="-"
                     description="time interval between calls to parameterization of long-wave radiation"
                     possible_values="`DD_HH:MM:SS' or `none'"/>

                <nml_option name="config_radtsw_interval" type="character" default_value="00:30:00"
                     units="-"
                     description="time interval between calls to parameterization of short-wave radiation"
                     possible_values="`DD_HH:MM:SS' or `none'"/>

                <nml_option name="config_conv_interval" type="character" default_value="none" in_defaults="false"
                     units="-"
                     description="time interval between calls to parameterization of convection"
                     possible_values="`DD_HH:MM:SS' or `none'"/>

                <nml_option name="config_pbl_interval" type="character" default_value="none" in_defaults="false"
                     units="-"
                     description="time interval between calls to parameterization of planetary boundary layer"
                     possible_values="`DD_HH:MM:SS' or `none'"/>

                <nml_option name="config_camrad_abs_update" type="character" default_value="06:00:00" in_defaults="false"
                     units="-"
                     description="time interval between updates of absorption/emission coefficients in CAM radiation"
                     possible_values="`DD_HH:MM:SS' or `none'"/>

                <nml_option name="config_greeness_update" type="character" default_value="24:00:00" in_defaults="false"
                     units="-"
                     description="time interval between updates of greeness fraction"
                     possible_values="`DD_HH:MM:SS' or `none'"/>

                <nml_option name="config_bucket_update" type="character" default_value="none"
                     units="-"
                     description="time interval between updates of accumulated rain and radiation diagnostics"
                     possible_values="`DD_HH:MM:SS' or `none'"/>

                <nml_option name="config_physics_suite" type="character" default_value="mesoscale_reference" in_defaults="true"
                     units="-"
                     description="Choice of physics suite"
                     possible_values="`mesoscale_reference',`convection_permitting',`none'"/>

                <nml_option name="config_microp_scheme" type="character" default_value="suite" in_defaults="false"
                     units="-"
                     description="configuration for cloud microphysics schemes"
                     possible_values="`suite',`mp_wsm6',`mp_thompson',`mp_kessler',`off'"/>

                <nml_option name="config_convection_scheme" type="character" default_value="suite" in_defaults="false"
                     units="-"
                     description="configuration for convection schemes"
                     possible_values="`suite',`cu_kain_fritsch',`cu_tiedtke',`cu_ntiedtke',`cu_grell_freitas',`off'"/>

                <nml_option name="config_lsm_scheme" type="character" default_value="suite" in_defaults="false"
                     units="-"
                     description="configuration for land-surface schemes"
                     possible_values="`suite',`noah',`off'"/>

                <nml_option name="config_pbl_scheme" type="character" default_value="suite" in_defaults="false"
                     units="-"
                     description="configuration for planetary boundary layer schemes"
                     possible_values="`suite',`bl_ysu',`bl_mynn',`off'"/>

                <nml_option name="config_gwdo_scheme" type="character" default_value="suite" in_defaults="false"
                     units="-"
                     description="configuration of gravity wave drag over orography"
                     possible_values="`suite',`bl_ysu_gwdo',`off'"/>

                <nml_option name="config_radt_cld_scheme" type="character" default_value="suite" in_defaults="false"
                     units="-"
                     description="configuration for calculation of horizontal cloud fraction"
                     possible_values="`suite',`cld_fraction',`cld_incidence'"/>

                <nml_option name="config_radt_lw_scheme" type="character" default_value="suite" in_defaults="false"
                     units="-"
                     description="configuration for long-wave radiation schemes"
                     possible_values="`suite',`rrtmg_lw',`cam_lw',`off'"/>

                <nml_option name="config_radt_sw_scheme" type="character" default_value="suite" in_defaults="false"
                     units="-"
                     description="configuration for short-wave radiation schemes"
                     possible_values="`suite',`rrtmg_sw',`cam_sw',`off'"/>

                <nml_option name="config_sfclayer_scheme" type="character" default_value="suite" in_defaults="false"
                     units="-"
                     description="configuration for surface layer-scheme"
                     possible_values="`suite',`sf_monin_obukhov',`sf_mynn',`off'"/>

                <nml_option name="config_gfconv_closure_deep" type="integer" default_value="0" in_defaults="false"
                     units="-"
                     description="closure option for deep convection in Grell-Freitas convection scheme"
                     possible_values="0"/>

                <nml_option name="config_gfconv_closure_shallow" type="integer" default_value="8" in_defaults="false"
                     units="-"
                     description="closure option for shallow convection in Grell-Freitas convection scheme"
                     possible_values="8"/>

                <nml_option name="config_bucket_radt" type="real" default_value="1.0e9" in_defaults="false"
                     units="-"
                     description="threshold above which accumulated radiation diagnostics are reset"
                     possible_values="Positive real values"/>

                <nml_option name="config_bucket_rainc" type="real" default_value="100.0" in_defaults="false"
                     units="-"
                     description="threshold above which the accumulated convective precipitation is reset"
                     possible_values="Positive real values"/>

                <nml_option name="config_bucket_rainnc" type="real" default_value="100.0" in_defaults="false"
                     units="-"
                     description="threshold above which the accumulated grid-scale precipitation is reset"
                     possible_values="Positive real values"/>

                <nml_option name="config_oml1d" type="logical" default_value="false" in_defaults="false"
                     units="-"
                     description="Whether to activate the 1-d ocean mixed-layer model"
                     possible_values=".true. or .false."/>

                <nml_option name="config_oml_hml0" type="real" default_value="30.0" in_defaults="false"
                     units="m"
                     description="If greater than zero, provides the constant, initial mixed-layer depth; if zero, initial mixed-layer depth will be taken from the `oml_initial` field." 
                     possible_values="Non-negative real values"/>

                <nml_option name="config_oml_gamma" type="real" default_value="0.14" in_defaults="false"
                     units="K m^{-1}"
                     description="Deep water lapse rate in 1-d OML model"
                     possible_values="Real values"/>

                <nml_option name="config_oml_relaxation_time" type="real" default_value="864000." in_defaults="false"
                     units="s"
                     description="Relaxation time to initial values in 1-d OML"
                     possible_values="Non-negative real values"/>
        </nml_record>

        <var_struct name="diag_physics" time_levs="1">


                <!-- ================================================================================================= -->
                <!-- ... ARRAYS AND VARIABLES FOR UPDATING THE DEEP SOIL TEMPERATURE:                                  -->
                <!-- ================================================================================================= -->

                <var name="nsteps_accum" type="real" dimensions="nCells Time" units="unitless"
                     description="number of accumulated time-steps in a day"/>

                <var name="ndays_accum" type="real" dimensions="nCells Time" units="unitless"
                     description="number of accumulated days in a year"/>

                <var name="tlag" type="real" dimensions="nLags nCells Time" units="K"
                     description="daily mean surface temperature of prior days"/>

                <var name="tday_accum" type="real" dimensions="nCells Time" units="K"
                     description="accumulated daily surface temperature for current day"/>

                <var name="tyear_mean" type="real" dimensions="nCells Time" units="K"
                     description="annual mean surface temperature"/>

                <var name="tyear_accum" type="real" dimensions="nCells Time" units="K"
                     description="accumulated yearly surface temperature for current year"/>


                <!-- ================================================================================================== -->
                <!-- ... PARAMETERIZATION OF CLOUD MICROPHYSICS:                                                        -->
                <!-- ================================================================================================== -->

                <var name="refl10cm_max" type="real" dimensions="nCells Time" units="dBZ"
                     description="10 cm maximum radar reflectivity"
                     packages="mp_thompson_in;mp_wsm6_in"/>

                <var name="refl10cm_1km" type="real" dimensions="nCells Time" units="dBZ"
                     description="diagnosed 10 cm radar reflectivity at 1 km AGL"
                     packages="mp_thompson_in;mp_wsm6_in"/>

                <var name="refl10cm_1km_max" type="real" dimensions="nCells Time" units="dBZ"
                     description="maximum diagnosed 10 cm radar reflectivity at 1 km AGL since last output time"
                     packages="mp_thompson_in;mp_wsm6_in"/>

                <var name="i_rainnc" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated grid-scale precipitation greater than config_bucket_rainnc"
                     packages="mp_kessler_in;mp_thompson_in;mp_wsm6_in"/>

                <var name="rainncv" type="real" dimensions="nCells Time" units="mm"
                     description="time-step total grid-scale precipitation"
                     packages="mp_kessler_in;mp_thompson_in;mp_wsm6_in"/>

                <var name="snowncv" type="real" dimensions="nCells Time" units="mm"
                     description="time-step grid-scale precipitation of snow"
                     packages="mp_thompson_in;mp_wsm6_in"/>

                <var name="graupelncv" type="real" dimensions="nCells Time" units="mm"
                     description="time-step grid-scale precipitation of graupel"
                     packages="mp_thompson_in;mp_wsm6_in"/>

                <var name="rainnc" type="real" dimensions="nCells Time" units="mm"
                     description="accumulated total grid-scale precipitation"
                     packages="mp_kessler_in;mp_thompson_in;mp_wsm6_in"/>

                <var name="snownc" type="real" dimensions="nCells Time" units="mm"
                     description="accumulated grid-scale precipitation of snow"
                     packages="mp_thompson_in;mp_wsm6_in"/>

                <var name="graupelnc" type="real" dimensions="nCells Time" units="mm"
                     description="accumulated grid-scale precipitation of graupel"
                     packages="mp_thompson_in;mp_wsm6_in"/>

                <var name="rainprod" type="real" dimensions="nVertLevels nCells Time" units="s^{-1}"
                     description="rain production rate"
                     packages="mp_thompson_in"/>

                <var name="evapprod" type="real" dimensions="nVertLevels nCells Time" units="s^{-1}"
                     description="rain evaporation rate"
                     packages="mp_thompson_in"/>

                <var name="re_cloud" type="real" dimensions="nVertLevels nCells Time" units="m"
                     description="effective radius of cloud water droplets"
                     packages="mp_thompson_in;mp_wsm6_in"/>

                <var name="re_ice"  type="real" dimensions="nVertLevels nCells Time"  units="m"
                     description="effective radius of cloud ice crystals"
                     packages="mp_thompson_in;mp_wsm6_in"/>

                <var name="re_snow" type="real" dimensions="nVertLevels nCells Time"  units="m"
                     description="effective radius of snow crystals"
                     packages="mp_thompson_in;mp_wsm6_in"/>

                <var name="nt_c" type="real" dimensions="nCells" units="nb kg^{-1}"
                     description="one-moment constant cloud water droplet concentration"
                     packages="mp_thompson_in"/>

                <var name="mu_c" type="real" dimensions="nCells" units="unitless"
                     description="gamma shape parameter"
                     packages="mp_thompson_in"/>

                <var name="sr" type="real" dimensions="nCells Time" units="unitless"
                     description="time-step ratio of frozen versus total grid-scale precipitation"/>

                <var name="precipw" type="real" dimensions="nCells Time" units="kg m^{-2}"
                     description="precipitable water"/>


                <!-- ================================================================================================== -->
                <!-- ... PARAMETERIZATION OF CONVECTION:                                                                -->
                <!-- ================================================================================================== -->

                <var name="i_rainc" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated convective precipitation greater than config_bucket_rainc"
                     packages="cu_grell_freitas_in;cu_kain_fritsch_in;cu_tiedtke_in"/>

                <var name="cuprec" type="real" dimensions="nCells Time" units="mm s^{-1}"
                     description="convective precipitation rate"
                     packages="cu_grell_freitas_in;cu_kain_fritsch_in;cu_tiedtke_in"/>

                <var name="rainc" type="real" dimensions="nCells Time" units="mm"
                     description="accumulated convective precipitation"
                     packages="cu_grell_freitas_in;cu_kain_fritsch_in;cu_tiedtke_in"/>

                <var name="raincv" type="real" dimensions="nCells Time" units="mm"
                     description="time-step convective precipitation"
                     packages="cu_grell_freitas_in;cu_kain_fritsch_in;cu_tiedtke_in"/>


                <!-- ... KAIN_FRITSCH ONLY: -->
                <var name="nca" type="real" dimensions="nCells Time" units="s"
                     description="relaxation time for KF parameterization of convection"
                     packages="cu_kain_fritsch_in"/>

                <var name="w0avg" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1}"
                     description="time running-averaged vertical velocity"
                     packages="cu_kain_fritsch_in"/>


                <!-- ... GRELL-FREITAS ONLY: -->
                <var name="k22_shallow" type="integer" dimensions="nCells Time" units="unitless"
                     description="index of convection at k22 level in Grell-Freitas convection scheme"
                     packages="cu_grell_freitas_in"/>

                <var name="kbcon_shallow" type="integer" dimensions="nCells Time" units="unitless"
                     description="index of lowest level of shallow convection in Grell-Freitas convection scheme"
                     packages="cu_grell_freitas_in"/>

                <var name="ktop_shallow" type="integer" dimensions="nCells Time" units="unitless"
                     description="index of highest level of shallow convection in Grell-Freitas convection scheme"
                     packages="cu_grell_freitas_in"/>

                <var name="ktop_deep" type="integer" dimensions="nCells Time" units="unitless"
                     description="index of highest level of deep convection in Grell-Freitas convection scheme"
                     packages="cu_grell_freitas_in"/>

                <var name="xmb_total" type="real" dimensions="nCells Time" units="kg m^{-2} s^{-1}"
                     description="cloud-base mass flux"
                     packages="cu_grell_freitas_in"/>

                <var name="xmb_shallow" type="real" dimensions="nCells Time" units="kg m^{-2} s^{-1}"
                     description="cloud base mass flux for shallow convection"
                     packages="cu_grell_freitas_in"/>

                <var name="qc_cu" type="real" dimensions="nVertLevels nCells Time" units="kg kg^{-1}"
                     description="in-cloud cloud water mixing ratio in Grell-Freitas cloud model"
                     packages="cu_grell_freitas_in"/>

                <var name="qi_cu" type="real" dimensions="nVertLevels nCells Time" units="kg kg^{-1}"
                     description="in-cloud cloud ice mixing ratio in Grell-Freitas cloud model"
                     packages="cu_grell_freitas_in"/>


                <!-- ... KAIN_FRITSCH AND GRELL-FREITAS: -->
                <var name="cubot" type="real" dimensions="nCells Time" units="unitless"
                     description="index of highest level of convection"
                     packages="cu_grell_freitas_in;cu_kain_fritsch_in"/>

                <var name="cutop" type="real" dimensions="nCells Time" units="unitless"
                     description="index of lowest level of convection"
                     packages="cu_grell_freitas_in;cu_kain_fritsch_in"/>


                <!-- ================================================================================================== -->
                <!-- ... PARAMETERIZATION OF PLANETARY BOUNDARY LAYER PROCESSES:                                        -->
                <!-- ================================================================================================== -->

                <var name="kpbl" type="integer" dimensions="nCells Time" units="unitless"
                     description="index level of PBL top"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="hpbl" type="real" dimensions="nCells Time" units="m"
                     description="Planetary Boundary Layer (PBL) height"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="delta" type="real" dimensions="nCells Time" units="m"
                     description="entrainment layer depth from PBL scheme"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="wstar" type="real" dimensions="nCells Time" units="m s^{-1}"
                     description="mixed velocity scale from PBL scheme"
                     packages="bl_mynn_in;bl_ysu_in"/>

		<var name="kzh" type="real" dimensions="nVertLevels nCells Time" units="m^{2} s^{-1}"
                     description="vertical diffusion coefficient of potential temperature"
                     packages="bl_mynn_in;bl_ysu_in"/>

		<var name="kzm" type="real" dimensions="nVertLevels nCells Time" units="m^{2} s^{-1}"
                     description="vertical diffusion coefficient of mommentum"
                     packages="bl_mynn_in;bl_ysu_in"/>

		<var name="kzq" type="real" dimensions="nVertLevels nCells Time" units="m^{2} s^{-1}"
                     description="vertical diffusion coefficient of water vapor and cloud condensates"
                     packages="bl_mynn_in;bl_ysu_in"/>


                <!-- YSU PBL SCHEME: -->
                <var name="exch_h" type="real" dimensions="nVertLevels nCells Time" units="m^{2} s^{-1}"
                     description="exchange coefficient"
                     packages="bl_ysu_in"/>


                <!-- MYNN PBL SCHEME: -->
                <var name="cov" type="real" dimensions="nVertLevels nCells Time" units="K kg kg^{-1}"
                     description="liquid water - liquid water potential temperature covariance"
                     packages="bl_mynn_in"/>

                <var name="el_pbl" type="real" dimensions="nVertLevels nCells Time" units="m"
                     description="mixing length from PBL scheme"
                     packages="bl_mynn_in"/>

                <var name="qke" type="real" dimensions="nVertLevels nCells Time" units="m^{2} s^{-2}"
                     description="twice turbulent kinetic energy"
                     packages="bl_mynn_in"/>

                <var name="qke_adv" type="real" dimensions="nVertLevels nCells Time" units="m^{2} s^{-2}"
                     description="twice turbulent kinetic energy"
                     packages="bl_mynn_in"/>

                <var name="qsq" type="real" dimensions="nVertLevels nCells Time" units="{kg kg^{-1}}^2"
                     description="liquid water variance"
                     packages="bl_mynn_in"/>

                <var name="tsq" type="real" dimensions="nVertLevels nCells Time" units="K^{2}"
                     description="liquid water potential temperature variance"
                     packages="bl_mynn_in"/>

                <var name="tke_pbl" type="real" dimensions="nVertLevels nCells Time" units="m^{2} s^{-2}"
                     description="turbulent kinetic energy from PBL"
                     packages="bl_mynn_in"/>

                <var name="dqke" type="real" dimensions="nVertLevels nCells Time" units="m^{2} s^{-2}"
                     description="TKE change"
                     packages="bl_mynn_in"/>

                <var name="qbuoy" type="real" dimensions="nVertLevels nCells Time" units="m^{2} s^{-2}"
                     description="TKE production - buoyancy"
                     packages="bl_mynn_in"/>

                <var name="qdiss" type="real" dimensions="nVertLevels nCells Time" units="m^{2} s^{-2}"
                     description="TKE dissipation"
                     packages="bl_mynn_in"/>

                <var name="qshear" type="real" dimensions="nVertLevels nCells Time" units="m^{2} s^{-2}"
                     description="TKE production - shear"
                     packages="bl_mynn_in"/>

                <var name="qwt" type="real" dimensions="nVertLevels nCells Time" units="m^{2} s^{-2}"
                     description="TKE vertical distribution"
                     packages="bl_mynn_in"/>


                <!-- ================================================================================================== -->
                <!-- ... PARAMETERIZATION OF SURFACE LAYER PROCESSES:                                                   -->
                <!-- ================================================================================================== -->

                <var name="hfx" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="upward heat flux at the surface"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="mavail" type="real" dimensions="nCells Time" units="unitless"
                     description="surface moisture availability (between 0 and 1)"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="mol" type="real" dimensions="nCells Time" units="K"
                     description="T* in similarity theory"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="qfx" type="real" dimensions="nCells Time" units="kg m^{-2} s^{-1}"
                     description="upward moisture flux at the surface"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="qsfc" type="real"  dimensions="nCells Time" units="kg kg^{-1}"
                     description="specific humidity at lower boundary"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="ust" type="real" dimensions="nCells Time" units="m s^{-1}"
                     description="U* in similarity theory"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="ustm" type="real" dimensions="nCells Time" units="m s^{-1}"
                     description="U* in similarity theory without vconv"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="zol" type="real" dimensions="nCells Time" units="unitless"
                     description="z/L height over Monin-Obukhov length"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="br" type="real" dimensions="nCells Time" units="unitless"
                     description="Richardson number"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="cd" type="real" dimensions="nCells Time" units="unitless"
                     description="drag coefficient at 10-meter"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="cda" type="real" dimensions="nCells Time" units="unitless"
                     description="drag coefficient at lowest model level"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="chs" type="real" dimensions="nCells Time" units="m s^{-1}"
                     description="surface exchange coefficient for heat and moisture"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="chs2" type="real" dimensions="nCells Time" units="m s^{-1}"
                     description="surface exchange coefficient for heat at 2-meter"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="cqs2" type="real" dimensions="nCells Time" units="m s^{-1}"
                     description="surface exchange coefficient for moisture at 2-meter"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="ck" type="real" dimensions="nCells Time" units="unitless"
                     description="enthalpy exchange coeff at 10-meter"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="cka" type="real" dimensions="nCells Time" units="unitless"
                     description="enthalpy exchange coefficient at lowest model level"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="cpm" type="real" dimensions="nCells Time" units="J K^{-1} kg^{-1}"
                     description="specific heat of dry air at constant pressure at lowest model level"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="flhc" type="real" dimensions="nCells Time" units="W m^{-2} K^{-1}"
                     description="exchange coefficient for heat"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="flqc" type="real" dimensions="nCells Time" units="kg m^{-2} s^{-1}"
                     description="exchange coefficient for moisture"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="gz1oz0" type="real" dimensions="nCells Time" units="unitless"
                     description="log(z/z0) where z0 is roughness length"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="lh" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="latent heat flux at the surface"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="psim" type="real" dimensions="nCells Time" units="unitless"
                     description="similarity stability function for momentum"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="psih" type="real" dimensions="nCells Time" units="unitless"
                     description="similarity stability function for heat"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="qgh" type="real" dimensions="nCells Time" units="kg kg^{-1}"
                     description="lowest level saturation mixing ratio"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="regime" type="real" dimensions="nCells Time" units="unitless"
                     description="flag indicating the PBL regime (stable,unstable,...)"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="rmol" type="real" dimensions="nCells Time" units="unitless"
                     description="1./L Monin Obukhov length"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="wspd" type="real" dimensions="nCells Time" units="m s^{-1}"
                     description="wind speed at lowest model level"
                     packages="bl_mynn_in;bl_ysu_in"/>


                <!-- ... MONIN-OBUKHOV (SFCLAY): -->
                <var name="fh" type="real" dimensions="nCells Time" units="unitless"
                     description="integrated stability function for heat"
                     packages="bl_ysu_in"/>

                <var name="fm" type="real" dimensions="nCells Time" units="unitless"
                     description="integrated stability function for moisture"
                     packages="bl_ysu_in"/>


                <!-- ... MYNN: -->
                <var name="ch" type="real" dimensions="nCells Time" units="m s^{-1}"
                     description="surface exchange coefficient for heat"
                     packages="bl_mynn_in"/>

                <var name="qcg" type="real" dimensions="nCells Time" units="kg kg^{-1}"
                     description="cloud water mixing ratio at the ground surface"
                     packages="bl_mynn_in"/>

                <var name="sh3d" type="real" dimensions="nVertLevels nCells Time" units="unitless"
                     description="stability function for heat"
                     packages="bl_mynn_in"/>


                <!-- DIAGNOSTICS: -->
                <var name="u10" type="real" dimensions="nCells Time" packages="bl_mynn_in;bl_ysu_in" units="m s^{-1}"
                     description="10-meter zonal wind"/>

                <var name="v10" type="real" dimensions="nCells Time" packages="bl_mynn_in;bl_ysu_in" units="m s^{-1}"
                     description="10-meter meridional wind"/>

                <var name="q2" type="real" dimensions="nCells Time" packages="bl_mynn_in;bl_ysu_in" units="kg kg^{-1}"
                     description="2-meter specific humidity"/>

                <var name="t2m" type="real" dimensions="nCells Time" packages="bl_mynn_in;bl_ysu_in" units="K"
                     description="2-meter temperature"/>

                <var name="th2m" type="real" dimensions="nCells Time" packages="bl_mynn_in;bl_ysu_in" units="K"
                     description="2-meter potential temperature"/>


                <!-- ================================================================================================== -->
                <!-- ... PARAMETERIZATION OF GRAVITY WAVE DRAG OVER OROGRAPHY:                                          -->
                <!-- ================================================================================================== -->

		<var name="dusfcg" type="real" dimensions="nCells Time" units="Pa m s^{-1}"
                     description="vertically-integrated gravity wave drag over orography u-stress"/>

                <var name="dvsfcg" type="real" dimensions="nCells Time" units="Pa m s^{-1}"
                     description="vertically-integrated gravity wave drag over orography v-stress"/>

                <var name="dtaux3d" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1}"
                     description="gravity wave drag over orography u-stress"/>

                <var name="dtauy3d" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1}"
                     description="gravity wave drag over orography v-stress"/>

                <var name="rubldiff" type="real" dimensions="nVertLevels nCells Time" units="m s^{-2}"
                     description="change in PBL zonal wind tendency due to gravity wave drag over orography"/>

		<var name="rvbldiff" type="real" dimensions="nVertLevels nCells Time"  units="m s^{-2}"
                     description="change in PBL meridional wind tendency due to gravity wave drag over orography"/>


                <!-- ================================================================================================== -->
                <!-- ... PARAMETERIZATION OF SHORTWAVE RADIATION:                                                       -->
                <!-- ================================================================================================== -->

                <var name="i_acswdnb" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated all-sky downward surface shortwave radiation greater than config_bucket_radt"/>

                <var name="i_acswdnbc" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated clear-sky downward surface shortwave radiation greater than config_bucket_radt"/>

                <var name="i_acswdnt" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated all-sky downward top-of-atmosphere shortwave radiation greater than config_bucket_radt"/>

                <var name="i_acswdntc" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated clear-sky downward top-of-atmosphere shortwave radiation greater than config_bucket_radt"/>

                <var name="i_acswupb" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated all-sky upward surface shortwave radiation greater than config_bucket_radt"/>

                <var name="i_acswupbc" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated clear-sky upward surface shortwave radiation greater than config_bucket_radt"/>

                <var name="i_acswupt" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated all-sky upward top-of-atmosphere shortwave radiation greater than config_bucket_radt"/>

                <var name="i_acswuptc" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated clear-sky upward top-of-atmosphere shortwave radiation greater than config_bucket_radt"/>

                <var name="coszr" type="real" dimensions="nCells Time" units="unitless"
                     description="cosine of zenith solar angle"/>

                <var name="swcf" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="top-of-atmosphere cloud shortwave radiative forcing"/>

                <var name="swdnb" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="all-sky downward surface shortwave radiation flux"/>

                <var name="swdnbc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="clear-sky downward surface shortwave radiation flux"/>

                <var name="swdnt" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="all-sky downward top-of-atmosphere shortwave radiation flux"/>

                <var name="swdntc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="clear-sky downward top-of-atmosphere shortwave radiation flux"/>

                <var name="swupb" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="all-sky upward surface shortwave radiation flux"/>

                <var name="swupbc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="clear-sky upward surface shortwave radiation flux"/>

                <var name="swupt" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="all-sky upward top-of-atmosphere shortwave radiation flux"/>

                <var name="swuptc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="clear-sky upward top-of-atmosphere shortwave radiation flux"/>

                <var name="acswdnb" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated all-sky downward surface shortwave radiation flux"/>

                <var name="acswdnbc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated clear-sky downward surface shortwave radiation flux"/>

                <var name="acswdnt" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated all-sky downward top-of-atmosphere shortwave radiation flux"/>

                <var name="acswdntc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated clear-sky downward top-of-atmosphere shortwave radiation flux"/>

                <var name="acswupb" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated all-sky upward surface shortwave radiation flux"/>

                <var name="acswupbc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated clear-sky upward surface shortwave radiation flux"/>

                <var name="acswupt" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated all-sky upward top-of-atmosphere shortwave radiation flux"/>

                <var name="acswuptc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated clear-sky upward top-of-atmosphere shortwave radiation flux"/>

                <var name="gsw" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="net surface shortwave radiation flux"/>

                <!-- RRTMG SW ONLY: -->
                <var name="swdnflx" type="real" dimensions="nVertLevelsP2 nCells Time" units="-"
                     description="-"/>

                <var name="swdnflxc" type="real" dimensions="nVertLevelsP2 nCells Time" units="-"
                     description="-"/>

                <var name="swupflx" type="real" dimensions="nVertLevelsP2 nCells Time" units="-"
                     description="-"/>

                <var name="swupflxc" type="real" dimensions="nVertLevelsP2 nCells Time" units="-"
                     description="-"/>


                <!-- ================================================================================================== -->
                <!-- ... PARAMETERIZATION OF LONGWAVE RADIATION:                                                        -->
                <!-- ================================================================================================== -->

                <var name="nlrad" type="integer" dimensions="nCells Time" units="-"
                     description="number of layers added above the model-top in the RRTMG lw radiation code"/>

                <var name="plrad" type="real" dimensions="nCells Time" units="Pa"
                     description="pressure at model-top"/>

                <var name="i_aclwdnb" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated all-sky downward surface longwave radiation greater than config_bucket_radt"/>

                <var name="i_aclwdnbc" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated clear-sky downward surface longwave radiation greater than config_bucket_radt"/>

                <var name="i_aclwdnt" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated all-sky downward top-of-atmosphere longwave radiation greater than config_bucket_radt"/>

                <var name="i_aclwdntc" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated clear-sky downward top-of-atmosphere longwave radiation greater than config_bucket_radt"/>

                <var name="i_aclwupb"  type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated all-sky upward surface longwave radiation greater than config_bucket_radt"/>

                <var name="i_aclwupbc" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated clear-sky upward surface longwave radiation greater than config_bucket_radt"/>

                <var name="i_aclwupt" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated all-sky upward top-of-atmosphere longwave radiation greater than config_bucket_radt"/>

                <var name="i_aclwuptc" type="integer" dimensions="nCells Time" units="unitless"
                     description="incidence of accumulated clear-sky upward top-of-atmosphere longwave radiation greater than config_bucket_radt"/>

                <var name="lwcf" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="top-of-atmosphere cloud longwave radiative forcing"/>

                <var name="lwdnb" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="all-sky downward surface longwave radiation flux"/>

                <var name="lwdnbc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="clear-sky downward surface longwave radiation flux"/>

                <var name="lwdnt" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="all-sky downward top-of-the-atmosphere longwave radiation flux"/>

                <var name="lwdntc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="clear-sky downward top-of-the-atmosphere longwave radiation flux"/>

                <var name="lwupb" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="all-sky upward surface longwave radiation flux"/>

                <var name="lwupbc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="clear-sky upward surface longwave radiation flux"/>

                <var name="lwupt" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="all-sky upward top-of-the-atmosphere longwave radiation flux"/>

                <var name="lwuptc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="clear-sky upward top-of-the-atmosphere longwave radiation flux"/>

                <var name="aclwdnb" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated all-sky downward surface longwave radiation flux"/>

                <var name="aclwdnbc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated clear-sky downward surface longwave radiation flux"/>

                <var name="aclwdnt" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated all-sky downward top-of-the-atmosphere longwave radiation flux"/>

                <var name="aclwdntc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated clear-sky downward top-of-the-atmosphere longwave radiation flux"/>

                <var name="aclwupb" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated all-sky upward surface longwave radiation flux"/>

                <var name="aclwupbc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated clear-sky upward surface longwave radiation flux"/>

                <var name="aclwupt" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated all-sky upward top-of-the-atmosphere longwave radiation flux"/>

                <var name="aclwuptc" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="accumulated clear-sky upward top-of-the-atmosphere longwave radiation flux"/>

                <var name="olrtoa" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="all-sky top-of-atmosphere outgoing longwave radiation flux"/>

                <var name="glw" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="all-sky downward surface longwave radiation"/>

                <var name="rre_cloud" type="real" dimensions="nVertLevels nCells Time" units="microns"
                     description="effective radius of cloud water droplets calculated in RRTMG radiation"/>

                <var name="rre_ice" type="real" dimensions="nVertLevels nCells Time" units="microns"
                     description="effective radius of cloud ice crystals calculated in RRTMG radiation"/>

                <var name="rre_snow" type="real" dimensions="nVertLevels nCells Time" units="microns"
                     description="effective radius of snow crystals calculated in RRTMG radiation"/>


                <!-- ================================================================================================== -->
                <!-- ... ADDITIONAL "RADIATION" ARRAYS NEEDED ONLY IN THE "CAM" LW AND SW RADIATION CODES:              -->
                <!-- ================================================================================================== -->

                <var name="m_hybi" type="real" dimensions="nAerLevels nCells" units="unitless"
                     description="Matched hybi (needs to be re-checked)"/>

                <var name="m_ps" type="real" dimensions="nCells Time" units="Pa"
                     description="Surface pressure from match on MPAS grid"/>

                <!-- INFRARED ABSORPTION: -->
                <var name="absnxt" type="real" dimensions="nVertLevels cam_dim1 nCells Time" units="-"
                     description="Total nearest layer absorptivity"/>

                <var name="abstot" type="real" dimensions="nVertLevelsP1 nVertLevelsP1 nCells Time" units="-"
                     description="Total absorptivity"/>

                <var name="emstot" type="real" dimensions="nVertLevelsP1 nCells Time" units="-"
                     description="Total emissivity"/>


                <!-- ================================================================================================== -->
                <!-- ... ADDITIONAL OZONE ARRAYS NEEDED ONLY IN THE LW AND SW RADIATION CODES:                          -->
                <!-- ================================================================================================== -->

                <var name="o3clim" type="real" dimensions="nOznLevels nCells Time" units="mol mol^{-1}"
                     description="climatological ozone on prescribed pressure levels at current time"/>

                <var name="o3vmr" type="real" dimensions="nVertLevels nCells Time" units="mol mol^{-1}"
                     description="ozone volume mixing ratio"/>


                <!-- ================================================================================================== -->
                <!-- ... PARAMERIZATION OF CLOUDINESS:                                                                  -->
                <!-- ================================================================================================== -->

                <var name="cldfrac" type="real" dimensions="nVertLevels nCells Time" units="unitless"
                     description="horizontal cloud fraction"/>


                <!-- ================================================================================================== -->
                <!-- ... PARAMETERIZATION OF LAND-SURFACE SCHEME:                                                       -->
                <!-- ================================================================================================== -->

                <var name="acsnom" type="real" dimensions="nCells Time" units="kg m^{-2}"
                     description="accumulated melted snow"/>

                <var name="acsnow" type="real" dimensions="nCells Time" units="kg m^{-2}"
                     description="accumulated snow"/>

                <var name="canwat" type="real" dimensions="nCells Time" units="kg m^{-2}"
                     description="water in canopy"/>

                <var name="chklowq" type="real" dimensions="nCells Time" units="unitless"
                     description="surface saturation flag"/>

                <var name="grdflx" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="ground heat flux"/>

                <var name="lai" type="real" dimensions="nCells Time" units="m^{-2} m^{-2}"
                     description="leaf area index"/>

                <var name="noahres" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="residual of the Noah surface energy budget"/>

                <var name="potevp" type="real" dimensions="nCells Time" units="m"
                     description="accumulated potential evaporation"/>

                <var name="sfc_albedo" type="real" dimensions="nCells Time" units="unitless"
                     description="surface albedo"/>

                <var name="sfc_albedo_seaice" type="real" dimensions="nCells Time" units="unitless"
                     description="surface albedo over seaice"/>

                <var name="sfc_emiss" type="real" dimensions="nCells Time" units="unitless"
                     description="surface emissivity"/>

                <var name="sfc_emibck" type="real" dimensions="nCells Time" units="unitless"
                     description="background surface emissivity"/>

                <var name="sfcrunoff" type="real" dimensions="nCells Time" units="mm"
                     description="surface runoff"/>

                <var name="smstav" type="real" dimensions="nCells Time" units="unitless"
                     description="surface moisture availability"/>

                <var name="smstot" type="real" dimensions="nCells Time" units="m^{3} m^{-3}"
                     description="total soil mositure"/>

                <var name="snopcx" type="real" dimensions="nCells Time" units="W m^{-2}"
                     description="snow phase change heat flux"/>

                <var name="snotime" type="real" dimensions="nCells Time" units="unitless"
                     description="initial number of time-steps since last snow fall"/>

                <var name="sstsk" type="real" dimensions="nCells Time" units="K"
                     description="skin sea-surface temperature"/>

                <var name="sstsk_dtc" type="real" dimensions="nCells Time" units="K"
                     description="skin sea-surface temperature cooling"/>

                <var name="sstsk_dtw" type="real" dimensions="nCells Time" units="K"
                     description="skin sea-surface temperature warming"/>

                <var name="thc" type="real" dimensions="nCells Time" units="Cal cm^{-2} K^{-1} s^{-0.5}"
                     description="thermal inertia"/>

                <var name="udrunoff" type="real" dimensions="nCells Time" units="mm"
                     description="underground runoff"/>

                <var name="xicem" type="real" dimensions="nCells Time" units="unitless"
                     description="sea-ice flag from previsous time-step"/>

                <var name="z0" type="real" dimensions="nCells Time" units="m"
                     description="roughness height"/>

                <var name="znt" type="real" dimensions="nCells Time" units="m"
                     description="roughness length"/>

                <var name="zs" type="real" dimensions="nCells Time" units="m"
                     description="depth of centers of soil layers"/>

                <!-- ================================================================================================== -->
                <!-- ... PARAMETERIZATION OF THE 1D OCEAN MIXED LAYER                                                   -->
                <!-- ================================================================================================== -->

                <var name="t_oml"                 type="real" dimensions="nCells Time" units="K"
                     description="ocean mixed layer temperature"/>

                <var name="t_oml_initial"         type="real" dimensions="nCells Time" units="K"
                     description="ocean mixed layer temperature at initial time"/>

                <var name="t_oml_200m_initial"    type="real" dimensions="nCells Time" units="K"
                     description="ocean mixed layer 200 m mean temperature at initial time"/>

                <var name="h_oml"                 type="real" dimensions="nCells Time" units="m"
                     description="ocean mixed layer depth"/>

                <var name="h_oml_initial"         type="real" dimensions="nCells Time" units="m"
                     description="ocean mixed layer depth at initial time"/>

                <var name="hu_oml"                type="real" dimensions="nCells Time" units="m^2 s^{-1}"
                     description="ocean mixed layer integrated u (zonal velocity)"/>

                <var name="hv_oml"                type="real" dimensions="nCells Time" units="m^2 s^{-1}"
                     description="ocean mixed layer integrated v (meridional velocity)"/>

        </var_struct>

        <var_struct name="tend_physics" time_levs="1">
 
                <!-- ================================================================================================== -->
                <!-- TENDENCIES FROM PARAMETERIZATION OF CONVECTION:                                                    -->
                <!-- ================================================================================================== -->

                <var name="rthcuten" type="real" dimensions="nVertLevels nCells Time" units="K s^{-1}"
                     description="tendency of potential temperature due to cumulus convection"
                     packages="cu_grell_freitas_in;cu_kain_fritsch_in;cu_tiedtke_in"/>

                <var name="rqvcuten" type="real" dimensions="nVertLevels nCells Time" units="kg kg^{-1} s^{-1}"
                     description="tendency of water vapor mixing ratio due to cumulus convection"
                     packages="cu_grell_freitas_in;cu_kain_fritsch_in;cu_tiedtke_in"/>

                <var name="rqccuten" type="real" dimensions="nVertLevels nCells Time" units="kg kg^{-1} s^{-1}"
                     description="tendency of cloud water mixing ratio due to cumulus convection"
                     packages="cu_grell_freitas_in;cu_kain_fritsch_in;cu_tiedtke_in"/>

                <var name="rqicuten" type="real" dimensions="nVertLevels nCells Time" units="kg kg^{-1} s^{-1}"
                     description="tendency of cloud ice mixing ratio due to cumulus convection"
                     packages="cu_grell_freitas_in;cu_kain_fritsch_in;cu_tiedtke_in"/>


                <!-- KAIN_FRITSCH: -->
                <var name="rqrcuten" type="real" dimensions="nVertLevels nCells Time" units="kg kg^{-1} s^{-1}"
                     description="tendency of rain mixing ratio due to cumulus convection"
                     packages="cu_kain_fritsch_in"/>

                <var name="rqscuten" type="real" dimensions="nVertLevels nCells Time" units="kg kg^{-1} s^{-1}"
                     description="tendency of snow mixing ratio due to cumulus convection"
                     packages="cu_kain_fritsch_in"/>

                <!-- TIEDTKE AND GRELL -->
                <var name="rqvdynten" type="real" dimensions="nVertLevels nCells Time" units="kg kg^{-1} s^{-1}"
                     description="tendency of water vapor due to horizontal and vertical advections"
                     packages="cu_grell_freitas_in;cu_tiedtke_in"/>

                <var name="rthdynten" type="real" dimensions="nVertLevels nCells Time" units="K s^{-1}"
                     description="tendency of temperature due to horizontal and vertical advections"
                     packages="cu_grell_freitas_in;cu_tiedtke_in"/>

                <var name="rucuten" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1} s^{-1}"
                     description="tendency of zonal wind due to cumulus convection"
                     packages="cu_grell_freitas_in;cu_tiedtke_in"/>

                <var name="rvcuten" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1} s^{-1}"
                     description="tendency of meridional wind due to cumulus convection"
                     packages="cu_grell_freitas_in;cu_tiedtke_in"/>

	        <!-- MGD should we add packages to the field below? -->
	        <var name="rucuten_Edge" type="real"     dimensions="nVertLevels nEdges Time"/>


                <!-- ================================================================================================== -->
                <!-- ... TENDENCIES FROM PARAMETERIZATION OF PLANETARY BOUNDARY LAYER PROCESSES:                        -->
                <!-- ================================================================================================== -->

                <var name="rublten" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1} s^{-1}"
                     description="tendency of zonal wind due to pbl processes"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="rvblten" type="real" dimensions="nVertLevels nCells Time" units="m s^{-1} s^{-1}"
                     description="tendency of meridional wind due to pbl processes"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="rthblten" type="real" dimensions="nVertLevels nCells Time" units="K s^{-1}"
                     description="tendency of potential temperature due to pbl processes"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="rqvblten" type="real" dimensions="nVertLevels nCells Time" units="kg kg^{-1} s^{-1}"
                     description="tendency of water vapor mixing ratio due to pbl processes"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="rqcblten" type="real" dimensions="nVertLevels nCells Time" units="kg kg^{-1} s^{-1}"
                     description="tendency of cloud water mixing ratio due to pbl processes"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="rqiblten" type="real" dimensions="nVertLevels nCells Time" units="kg kg^{-1} s^{-1}"
                     description="tendency of cloud ice mixing ratio due to pbl processes"
                     packages="bl_mynn_in;bl_ysu_in"/>

                <var name="rniblten" type="real" dimensions="nVertLevels nCells Time" units="nb kg^{-1} s^{-1}"
                     description="tendency of cloud ice number concentration due to pbl processes"
                     packages="bl_mynn_in"/>

	        <!-- MGD should we add packages to the field below? -->
	        <var name="rublten_Edge" type="real"     dimensions="nVertLevels nEdges Time"/>


                <!-- ================================================================================================== -->
                <!-- ... TENDENCIES FROM PARAMETERIZATION OF LONGWAVE RADIATION:                                        -->
                <!-- ================================================================================================== -->
                <!--  rthratensw:uncoupled theta tendency due to shortwave radiation                            [K s-1] -->
                <!--  rthratenlw:uncoupled theta tendency due to longwave radiation                             [K s-1] -->

                <var name="rthratensw" type="real" dimensions="nVertLevels nCells Time" units="K s^{-1}"
                     description="tendency of potential temperature due to short wave radiation"/>

                <var name="rthratenlw" type="real" dimensions="nVertLevels nCells Time" units="K s^{-1}"
                     description="tendency of potential temperature due to long wave radiation"/>
        </var_struct>


        <var_struct name="atm_input" time_levs="1">
                <!-- Monthly mean ozone climatology used in the CAM and RRTMG radiation codes -->
                <var name="pin" type="real"  dimensions="nOznLevels" units="Pa"
                     description="fixed pressure levels at which climatological ozone is defined"/>

                <var name="ozmixm" type="real" dimensions="nMonths nOznLevels nCells" units="mol mol^{-1}"
                     description="monthly-mean climatological ozone defined at fixed pressure levels"/>
        </var_struct>


        <var_struct name="sfc_input" time_levs="1">

                <!-- ================================================================================================== -->
                <!-- ... SURFACE CHARACTERISTICS THAT NEED TO BE READ FROM GRID.NC:                                     -->
                <!-- ================================================================================================== -->

                <var name="isltyp" type="integer" dimensions="nCells" units="unitless"
                     description="dominant soil category"/>

                <var name="ivgtyp" type="integer" dimensions="nCells" units="unitless"
                     description="dominant vegetation category"/>

                <var name="mminlu" type="text" dimensions="" units="unitless"
                     description="land use classification"/>

                <var name="isice_lu" name_in_code="isice" type="integer" dimensions="" units="unitless" default_value="24"
                     description="Index category for snow/ice"/>

                <var name="iswater_lu" name_in_code="iswater" type="integer" dimensions="" units="unitless" default_value="16"
                     description="Index category for water"/>

                <var name="landmask" type="integer"  dimensions="nCells" units="unitless"
                     description="land-ocean mask (1=land ; 0=ocean)"/>

                <var name="shdmin" type="real" dimensions="nCells" units="unitless"
                     description="minimum fractional coverage of annual green vegetation fraction"/>

                <var name="shdmax" type="real" dimensions="nCells" units="unitless"
                     description="maximum fractional coverage of annual green vegetation fraction"/>

                <var name="snoalb" type="real"  dimensions="nCells" units="unitless"
                     description="annual maximum snow albedo"/>

                <var name="ter" type="real" dimensions="nCells" units="m"
                     description="terrain height"/>

                <var name="albedo12m" type="real" dimensions="nMonths nCells" units="unitless"
                     description="monthly-mean climatological aurface albedo"/>

                <var name="greenfrac" type="real" dimensions="nMonths nCells" units="unitless"
                     description="monthly-mean climatological greeness fraction"/>

                <var name="dzs" type="real" dimensions="nSoilLevels nCells Time" units="m"
                     description="soil layer thickness"/>

                <var name="sfc_albbck" type="real" dimensions="nCells Time" units="unitless"
                     description="background surface albedo"/>

                <var name="skintemp" type="real" dimensions="nCells Time" units="K"
                     description="ground or water surface temperature"/>

                <var name="snow" type="real" dimensions="nCells Time" units="kg m^{-2}"
                     description="snow water equivalent"/>

                <var name="snowc" type="real" dimensions="nCells Time" units="unitless"
                     description="flag for snow on ground (=0 no snow; =1,otherwise"/>

                <var name="snowh" type="real" dimensions="nCells Time" units="m"
                     description="physical snow depth"/>

                <var name="sst" type="real" dimensions="nCells Time" units="K"
                     description="sea-surface temperature"/>

                <var name="tmn" type="real" dimensions="nCells Time" units="K"
                     description="deep soil temperature"/>

                <var name="vegfra" type="real" dimensions="nCells Time" units="unitless"
                     description="vegetation fraction"/>

                <var name="seaice" type="real" dimensions="nCells Time" units="unitless"
                     description="sea-ice flag (0=no seaice; =1 otherwise)"/>

                <var name="xice" type="real" dimensions="nCells Time" units="unitless"
                     description="fractional area coverage of sea-ice"/>

                <var name="xland" type="real" dimensions="nCells Time" units="unitless"
                     description="land-ocean mask (1=land including sea-ice ; 2=ocean)"/>

                <var name="smcrel" type="real" dimensions="nSoilLevels nCells Time" units="m3 m^{-3}"
                     description="soil moisture threshold below which transpiration begins to stress"/>

                <var name="sh2o" type="real" dimensions="nSoilLevels nCells Time" units="m3 m^{-3}"
                     description="soil equivalent liquid water "/>

                <var name="smois" type="real" dimensions="nSoilLevels nCells Time" units="m3 m^{-3}"
                     description="soil moisture"/>

                <var name="tslb" type="real" dimensions="nSoilLevels nCells Time" units="K"
                     description="soil layer temperature"/>


                <!-- ================================================================================================== -->
                <!-- ... PARAMETERIZATION OF GRAVITY WAVE DRAG OVER OROGRAPHY:                                          -->
                <!-- ================================================================================================== -->

                <var name="var2d" type="real" dimensions="nCells" units="m^{2}"
                     description="variance of orography"/>

                <var name="con" type="real" dimensions="nCells" units="m^{2}"
                     description="convexity of orography"/>

                <var name="oa1" type="real" dimensions="nCells" units="unitless"
                     description="directional asymmetry function of orography"/>

                <var name="oa2" type="real" dimensions="nCells" units="unitless"
                     description="directional asymmetry function of orography"/>

                <var name="oa3" type="real" dimensions="nCells" units="unitless"
                     description="directional asymmetry function of orography"/>

                <var name="oa4" type="real" dimensions="nCells" units="unitless"
                     description="directional asymmetry function of orography"/>

                <var name="ol1" type="real" dimensions="nCells" units="unitless"
                     description="directional asymmetry function of orography"/>

                <var name="ol2" type="real" dimensions="nCells" units="unitless"
                     description="directional asymmetry function of orography"/>

                <var name="ol3" type="real" dimensions="nCells" units="unitles"
                     description="directional asymmetry function of orography"/>

                <var name="ol4" type="real" dimensions="nCells" units="unitless"
                     description="directional asymmetry function of orography"/>
        </var_struct>

        <var_struct name="tend_iau" time_levs="1" packages="iau">
			
                <!-- analysis increments; read from iau input -->
                <var name="u_amb"     name_in_code="u" type="real" dimensions="nVertLevels nEdges Time" units="m s^{-1}"
                     description="Horizontal normal velocity increment"/>

                <var name="rho_amb"   name_in_code="rho" type="real" dimensions="nVertLevels nCells Time" units="kg m^{-3}"
                     description="Dry air density increment"/>

                <var name="theta_amb" name_in_code="theta" type="real" dimensions="nVertLevels nCells Time" units="K"
                     description="Potential temperature increment"/>

                <var_array name="scalars_amb" name_in_code="scalars" type="real" dimensions="nVertLevels nCells Time">
                     <var name="qv_amb"  name_in_code="qv" array_group="moist" units="kg kg^{-1}"
                          description="Water vapor mixing ratio increment"/>

                     <var name="qc_amb"  name_in_code="qc" array_group="moist" packages="bl_mynn_in;bl_ysu_in;cu_tiedtke_in;mp_kessler_in;mp_thompson_in;mp_wsm6_in" units="kg kg^{-1}"
                          description="Cloud water mixing ratio increment"/>

                     <var name="qr_amb"  name_in_code="qr" array_group="moist" packages="mp_kessler_in;mp_thompson_in;mp_wsm6_in" units="kg kg^{-1}"
                          description="Rain water mixing ratio increment"/>

                     <var name="qi_amb"  name_in_code="qi" array_group="moist" packages="bl_mynn_in;bl_ysu_in;cu_tiedtke_in;mp_thompson_in;mp_wsm6_in" units="kg kg^{-1}"
                          description="Ice mixing ratio increment"/>

                     <var name="qs_amb"  name_in_code="qs" array_group="moist" packages="mp_thompson_in;mp_wsm6_in" units="kg kg^{-1}"
                          description="Snow mixing ratio increment"/>

                     <var name="qg_amb"  name_in_code="qg" array_group="moist" packages="mp_thompson_in;mp_wsm6_in" units="kg kg^{-1}"
                          description="Graupel mixing ratio increment"/>
                </var_array>
         </var_struct>


<!-- **************************************************************************************** -->
<!-- ************************************** Diagnostics ************************************* -->
<!-- **************************************************************************************** -->

#include "diagnostics/Registry_diagnostics.xml"

</registry>
