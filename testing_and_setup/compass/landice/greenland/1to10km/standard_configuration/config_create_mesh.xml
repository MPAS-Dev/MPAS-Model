<?xml version="1.0"?>
<config case="create_mesh">

	<add_link source_path="mpas_model" source="testing_and_setup/compass/ocean/jigsaw_to_MPAS" dest="jigsaw_to_MPAS"/>
	<add_link source_path="script_test_dir" source="." dest="define_base_mesh"/>
	<add_link source_path="script_test_dir" source="greenland_1km_2017_06_27.epsg3413.nc" dest="."/>
	<add_link source_path="script_test_dir" source="greenland_8km_2017_06_27.epsg3413.nc" dest="."/>

	<run_script name="create_mesh.py">
		<step executable="python">
			<argument flag="-m">jigsaw_to_MPAS.build_mesh</argument>
			<argument flag="--geometry">plane</argument>
                </step>

                <step executable="MpasCellCuller.x" >
                        <argument flag="">base_mesh.nc</argument>
                        <argument flag="">grid_culled.nc</argument>
                </step>


                <step executable="MpasMeshConverter.x" >
                        <argument flag="">grid_culled.nc</argument>
                        <argument flag="">grid_converted.nc</argument>
                </step>

                <!-- Convert from basic MPAS mesh to MPASLI mesh -->
                <step executable="create_landice_grid_from_generic_MPAS_grid.py" pre_message="\n\n### Creating LI mesh\n\n" post_message="\n\n### LI mesh creation complete\n\n">
                        <argument flag="-i">grid_converted.nc</argument>
                        <argument flag="-o">gis_1km.nc</argument>
                        <argument flag="-l">10</argument>
                        <argument flag="-v">glimmer</argument>
                        <argument flag="--beta"></argument>
                        <argument flag="--thermal"></argument>
                        <argument flag="--obs"></argument>
                        <argument flag="--diri"></argument>
                </step>

                <!-- Set up initial condition on to landice mesh -->
                <step executable="interpolate_to_mpasli_grid.py" pre_message="\n\n### Setting up initial condition\n\n" post_message="\n\n### Initial condition setup complete\n\n">
                        <argument flag="-s">greenland_1km_2017_06_27.epsg3413.nc</argument>
                        <argument flag="-d">gis_1km.nc</argument>
                        <argument flag="-m">b</argument>
                        <argument flag="-t"></argument>
                </step>

                <!-- Add lat/lon  -->
                <step executable="set_lat_lon_fields_in_planar_grid.py" pre_message="\n\n### Setting lat/lon\n\n" post_message="\n\n### Setting lat/lon complete\n\n">
                        <argument flag="-f">gis_1km.nc</argument>
                        <argument flag="-p">gimp</argument>
                </step>




	</run_script>

</config>
